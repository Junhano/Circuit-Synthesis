 circuit: LNA
.include ../assets/45nm_CS.pm
.option TEMP=27C

R2 vdd net7 700
R1 net2 net9 10k
R0 vdd net2 800
C1 net7 net6 1p
C0 net8 net9 10p
Lg net9 net4 14.8n
Ld vdd net7 4.4n
Ls net5 0 58.3p
V0 vdd 0 dc 1.2
mn2 net2 net2 0 0 NMOS w=7u l=45n
mn1 net7 vdd net1 0 NMOS w=51u l=45n
mn0 net1 net4 net5 0 NMOS w=51u l=45n
V1 net9 0 dc 0 sin(0 100m 2.4G) portnum 1 z0 50
V2 net6 0 dc 0 ac 0 portnum 2 z0 50

.control
set ls_array = ( 5.942679108977317e-11 6.008608700633048e-11 5.975414486527443e-11 5.868662087172269e-11 6.031675966382026e-11 5.915890680551529e-11 5.979993911385536e-11 5.941008249223232e-11 5.974564181566238e-11 6.006100254058837e-11 6.081103669404983e-11 5.983847143054008e-11 5.908156635165214e-11 5.917870821356773e-11 5.927035527229308e-11 5.884157853126525e-11 5.979881213903426e-11 5.98676525235176e-11 6.076252074837685e-11 6.07833957850933e-11 5.86885494917631e-11 5.927620621323585e-11 5.930718818604946e-11 5.874958345592022e-11 5.981102691888808e-11 5.925254458487033e-11 5.899227084517478e-11 6.027854831814766e-11 5.930440196692943e-11 6.027934806346893e-11 5.884374318569898e-11 6.055867286324501e-11 5.92949654340744e-11 5.881616668701171e-11 5.927408153116703e-11 5.927704976797103e-11 5.917154164910316e-11 5.972066419124603e-11 5.863297084271908e-11 5.914987320005893e-11 5.976947398781776e-11 5.939162233769893e-11 5.983692692518234e-11 5.907400401234626e-11 6.026633487939835e-11 5.833515875898301e-11 5.826387264691292e-11 5.947511041462421e-11 5.983570920228957e-11 5.875299138873815e-11 6.028965594172478e-11 5.932031655609607e-11 6.030122252106667e-11 5.828433577828109e-11 5.88325574055314e-11 5.978355558514594e-11 6.031134070754051e-11 6.021049933433532e-11 6.016625078320503e-11 6.026855768561363e-11 5.966215820908546e-11 5.87601565748453e-11 5.928733335733413e-11 5.830553614459931e-11 5.915856057703494e-11 5.974690111279487e-11 5.930049249827861e-11 5.904649527668953e-11 5.97546300470829e-11 6.038930060267448e-11 5.875533634722232e-11 6.079053120613097e-11 5.9931391197443e-11 6.073814036250114e-11 5.978471936583518e-11 5.927317837178706e-11 5.927378119826316e-11 5.930310161709785e-11 5.971892001032829e-11 6.07599514901638e-11 5.876073965728283e-11 5.981304438710212e-11 5.825886429212986e-11 6.005944849848747e-11 5.87895045980811e-11 5.979892970919608e-11 5.981174053549766e-11 5.939795987606047e-11 5.920607032179832e-11 5.878203162848948e-11 5.929397249519824e-11 5.928491638898849e-11 6.020384313464165e-11 6.028326110839844e-11 6.078042628169059e-11 5.97632610976696e-11 5.931109251379967e-11 5.929115826189517e-11 5.979976715445517e-11 5.9436259958148e-11 6.01131287395954e-11 5.919340895414351e-11 5.948556581437587e-11 6.079108240008354e-11 5.876711273491382e-11 6.042927356362343e-11 5.932200992405414e-11 5.957006098628043e-11 6.047960014939308e-11 5.991712005734443e-11 5.90469406723976e-11 5.877264415770768e-11 5.933178299963474e-11 5.934859858751296e-11 5.873673258274792e-11 6.076588364243507e-11 6.009545283317566e-11 6.034389795660972e-11 6.043972583413123e-11 6.076341288089751e-11 5.939650865197181e-11 5.979963974952697e-11 5.928136007785796e-11 6.078998835682869e-11 5.979180218577385e-11 5.981254698634147e-11 6.011259527802466e-11 5.895856508910656e-11 5.880097163766622e-11 5.980377631187439e-11 5.980891855359077e-11 5.887054508477448e-11 5.928171733319758e-11 5.833798474557697e-11 5.945815743803977e-11 6.073705332279205e-11 5.968820737600325e-11 6.025094138383865e-11 5.979966552853584e-11 5.88068764090538e-11 5.939794571995734e-11 5.827637233696878e-11 5.927458347678183e-11 6.07799308180809e-11 5.990292044281959e-11 6.033816831111908e-11 5.944929810166358e-11 5.921606222093104e-11 6.00848964035511e-11 5.87502335563302e-11 5.939793849289416e-11 6.02649814069271e-11 5.877919660806655e-11 5.930705124437809e-11 5.880066035240887e-11 5.904583396315574e-11 6.028677942156791e-11 5.932101542055606e-11 5.931323604583739e-11 5.974592598080635e-11 5.927868889570236e-11 6.078321041464805e-11 6.030575366616248e-11 5.926774019300937e-11 5.878747733235358e-11 5.827602610848843e-11 5.930372806191444e-11 5.877078974545002e-11 5.918599532842635e-11 5.846331501305103e-11 5.875649170875549e-11 5.878324428498744e-11 5.944444904029369e-11 6.027000548243522e-11 5.94121043562889e-11 6.009522544145583e-11 5.931122595369815e-11 6.081688688993454e-11 6.030082257390022e-11 5.920535216033458e-11 )
set ld_array = ( 4.8958781003952026e-09 4.899464869499207e-09 4.400384375452995e-09 4.405497626960277e-09 4.897727155685425e-09 4.402519659698009e-09 4.896750175952911e-09 4.892199540138245e-09 4.897456312179566e-09 4.896130645275116e-09 4.89405312538147e-09 4.9000019073486335e-09 4.900214695930481e-09 4.401463234424591e-09 4.89778825044632e-09 4.3980916827917094e-09 4.8988340735435485e-09 4.417654530704021e-09 4.3997539967298505e-09 4.900198245048523e-09 4.405453482270241e-09 4.403327056765556e-09 4.899362707138062e-09 4.398748660087585e-09 4.400941857695579e-09 4.397132107615471e-09 4.398055502772331e-09 4.400157341361046e-09 4.8970321059226995e-09 4.401789852976799e-09 4.898669266700745e-09 4.8974309802055365e-09 4.404400238394737e-09 4.899880611896515e-09 4.402235136926174e-09 4.900038146972657e-09 4.413301014900207e-09 4.900189363956452e-09 4.405063369870186e-09 4.884420359134675e-09 4.397901037335396e-09 4.894241118431092e-09 4.896951162815094e-09 4.89809867143631e-09 4.898321890830994e-09 4.899223589897156e-09 4.4032037124037745e-09 4.899371647834778e-09 4.896887266635895e-09 4.400768899917603e-09 4.895716094970703e-09 4.408447844535112e-09 4.897266352176667e-09 4.395963923633099e-09 4.898635351657868e-09 4.8982060790061955e-09 4.397051201760769e-09 4.395413929224014e-09 4.403621146082878e-09 4.404250980913639e-09 4.8986197352409366e-09 4.8942350387573246e-09 4.401904904842376e-09 4.8998200535774235e-09 4.4009747818112374e-09 4.897504472732544e-09 4.402709664404392e-09 4.399226085841656e-09 4.89932873249054e-09 4.401374304294586e-09 4.89741792678833e-09 4.897872829437256e-09 4.403929436206818e-09 4.400739887356758e-09 4.404252068698406e-09 4.899230980873108e-09 4.899929189682007e-09 4.397214883565903e-09 4.4047099068760875e-09 4.405648531019688e-09 4.89428528547287e-09 4.896337532997132e-09 4.400116251409054e-09 4.896131837368012e-09 4.402030618488789e-09 4.898915433883667e-09 4.896353209018708e-09 4.399402835965157e-09 4.399730244278908e-09 4.406942875683307e-09 4.899609887599945e-09 4.397736521065235e-09 4.902016484737396e-09 4.401774787902832e-09 4.897076332569123e-09 4.398570531606674e-09 4.399723225831985e-09 4.899022722244263e-09 4.896758818626404e-09 4.897668981552124e-09 4.390669071674347e-09 4.896775090694428e-09 4.4036690384149555e-09 4.89790108203888e-09 4.397722715139389e-09 4.900544607639313e-09 4.8974920749664306e-09 4.8974446296691895e-09 4.381224447488785e-09 4.39975174665451e-09 4.399242901802063e-09 4.3993645772337915e-09 4.4021950677037236e-09 4.4022245049476625e-09 4.898428285121918e-09 4.399782048165798e-09 4.899166309833527e-09 4.899682664871216e-09 4.887868905067444e-09 4.399761782586574e-09 4.398135499656201e-09 4.400418961048126e-09 4.400624209642411e-09 4.897990131378174e-09 4.40188922137022e-09 4.3961907118558884e-09 4.390694001317024e-09 4.901104354858399e-09 4.8972600340843205e-09 4.407977932691574e-09 4.4072934739291666e-09 4.8994434118270876e-09 4.400608488917351e-09 4.400619739294052e-09 4.4007994174957275e-09 4.400711768865585e-09 4.897312128543854e-09 4.402327427268028e-09 4.896765434741974e-09 4.898590350151062e-09 4.39491985887289e-09 4.40117439031601e-09 4.899929130077362e-09 4.897069001197815e-09 4.402390414476394e-09 4.404102692008018e-09 4.896400833129883e-09 4.896837973594666e-09 4.899491453170777e-09 4.4062798820436e-09 4.394964644312859e-09 4.898303532600403e-09 4.8981238842010505e-09 4.899376714229584e-09 4.89727988243103e-09 4.399205961823464e-09 4.403026328980923e-09 4.408407786488533e-09 4.401403734087944e-09 4.897466564178467e-09 4.899482393264771e-09 4.897984528541565e-09 4.403059573471546e-09 4.900335514545441e-09 4.407015340030193e-09 4.898796343803406e-09 4.89696296453476e-09 4.89812138080597e-09 4.900107765197754e-09 4.406283789873123e-09 4.897196674346924e-09 4.898366236686707e-09 4.89651974439621e-09 4.404199631512165e-09 4.892197632789612e-09 4.897418522834778e-09 4.895879828929902e-09 4.898837411403657e-09 4.897251272201538e-09 4.3952492862939836e-09 )
set lg_array = ( 1.4803423766493797e-08 1.5179066228866576e-08 1.551712026596069e-08 1.5284162902832032e-08 1.5519518432617185e-08 1.4802520334124565e-08 1.4802930644154548e-08 1.502717447757721e-08 1.4797152161002159e-08 1.565307636260986e-08 1.4799972686171532e-08 1.527744959831238e-08 1.5280678291320802e-08 1.4820629704594611e-08 1.575927141189575e-08 1.5258878927230836e-08 1.528004566192627e-08 1.5701794204711913e-08 1.5768945960998533e-08 1.4804635545611381e-08 1.528420003890991e-08 1.5673212184906004e-08 1.5750681076049802e-08 1.5043378467559814e-08 1.5760707931518552e-08 1.5281507415771485e-08 1.5027912664413454e-08 1.5523000183105467e-08 1.5041941947937012e-08 1.5278210315704347e-08 1.5516022033691406e-08 1.4822153903841972e-08 1.552171083450317e-08 1.4800686200261117e-08 1.5281424446105958e-08 1.5760745124816892e-08 1.553667203903198e-08 1.5040157585144043e-08 1.5766450347900388e-08 1.559082565307617e-08 1.4803619185090065e-08 1.5424995841979978e-08 1.575756366729736e-08 1.5757590103149412e-08 1.5279593992233275e-08 1.5751513118743896e-08 1.552146312713623e-08 1.503487380504608e-08 1.575731819152832e-08 1.480239621937275e-08 1.5028334908485414e-08 1.4810646676421165e-08 1.550850709915161e-08 1.551974697113037e-08 1.551632873535156e-08 1.5031089243888856e-08 1.4794626736044884e-08 1.4836853594779968e-08 1.575895412445068e-08 1.576065128326416e-08 1.5766433982849118e-08 1.5760571632385253e-08 1.527313720703125e-08 1.503812291145325e-08 1.550871784210205e-08 1.4796816720366478e-08 1.5670244674682616e-08 1.528085876464844e-08 1.5040652570724487e-08 1.5751642551422117e-08 1.553019290924072e-08 1.480064605653286e-08 1.5044328241348265e-08 1.5519799385070798e-08 1.551538213729858e-08 1.5761742706298826e-08 1.5524487113952636e-08 1.5769716720581053e-08 1.5765419921875e-08 1.552082906723022e-08 1.5760677947998045e-08 1.528231262207031e-08 1.4800395550727844e-08 1.5654101982116698e-08 1.552121856689453e-08 1.527995101928711e-08 1.528207670211792e-08 1.5520484657287596e-08 1.5283733577728272e-08 1.5515843048095703e-08 1.5762943878173828e-08 1.50394633436203e-08 1.4800010251402855e-08 1.5278290996551513e-08 1.5277916088104247e-08 1.5287866954803468e-08 1.5762830352783203e-08 1.5762057876586914e-08 1.480292007625103e-08 1.527198055267334e-08 1.4803051618933678e-08 1.5277830715179443e-08 1.5261029815673828e-08 1.4800607232451439e-08 1.4801003941893577e-08 1.5037013134956358e-08 1.5277406311035156e-08 1.5520291252136227e-08 1.4833510596752166e-08 1.551811241149902e-08 1.5281076717376708e-08 1.4798998207449913e-08 1.575911491394043e-08 1.5759478950500486e-08 1.550758647918701e-08 1.5769259185791013e-08 1.5767373886108398e-08 1.5519951820373535e-08 1.550067859649658e-08 1.5769052963256833e-08 1.504090654373169e-08 1.5034880328178406e-08 1.5275380764007567e-08 1.527998435020447e-08 1.5040786781311036e-08 1.4804288110136987e-08 1.480295819222927e-08 1.5579018840789794e-08 1.503706241607666e-08 1.5272544574737548e-08 1.5506989154815674e-08 1.5517708206176756e-08 1.527528094291687e-08 1.5045153875350952e-08 1.5519752922058103e-08 1.5519723625183104e-08 1.4797093395590782e-08 1.529234851837158e-08 1.4802908739447594e-08 1.4808283467888832e-08 1.5245144300460816e-08 1.5042435417175293e-08 1.552450942993164e-08 1.527799367904663e-08 1.576313568115234e-08 1.5761332778930662e-08 1.573763784408569e-08 1.4803621976822614e-08 1.5179595432281495e-08 1.5281399841308594e-08 1.5245447025299073e-08 1.5279628324508668e-08 1.5278695430755614e-08 1.5749627304077147e-08 1.503718496799469e-08 1.5280610542297364e-08 1.5694033164978025e-08 1.4810566145777702e-08 1.5523705368041992e-08 1.4797082852721215e-08 1.5757607269287108e-08 1.527635362625122e-08 1.569434673309326e-08 1.5279803419113158e-08 1.551529830932617e-08 1.5515373954772947e-08 1.5041701908111574e-08 1.527876838684082e-08 1.5281213073730467e-08 1.5728589572906493e-08 1.5754941425323485e-08 1.576001281738281e-08 1.573647964477539e-08 1.576085624694824e-08 1.5026918888092042e-08 1.5515941925048827e-08 1.4803990427851677e-08 1.4803334388136865e-08 1.5508319530487058e-08 1.504235339164734e-08 )
set r_array = ( 999.3761211633682 845.9795705974102 894.0093696117401 900.1250445842743 845.965239405632 896.511073410511 996.0987597703934 905.8487668633461 895.8582386374474 854.9524761736393 1046.449038386345 898.4295234084129 799.4090562686324 802.8487262316048 997.4702030420303 1046.8604743480682 948.6235857009888 946.0122913122177 1046.516153216362 799.553500674665 900.1820862293243 1043.2944625616074 799.5177397504449 947.2923904657364 944.879475235939 997.967916727066 996.4855939149857 897.1346199512482 948.3650058507919 797.4336549639702 846.7139109969139 827.2100158035755 798.2089810073376 800.0431397929788 998.9313215017319 997.0931440591812 1036.9152158498764 801.5342375263572 899.0203469991684 813.413218781352 997.584718465805 1000.5144953727722 1047.9683458805084 797.824470512569 948.0028480291367 897.2729176282883 997.7908462285995 996.4824497699738 1047.9110807180405 947.235557436943 797.8423546999693 1044.6696907281876 895.8673283457756 1048.6745566129684 846.7718727886677 996.3573098182678 847.7536655962467 846.2538935244083 897.2882211208344 799.4937153533101 1048.0216324329376 1046.9915449619293 996.2297260761261 848.3783185482025 895.6912636756897 896.0194543004036 1043.2923465967178 847.5424900650978 948.8944441080093 893.3779627084732 1048.1494396924973 846.692494302988 898.7539663910866 946.68308198452 798.4254278242588 895.6229493021965 799.2461008951068 1048.1266111135483 896.6549515724182 849.3400134146214 1047.044786810875 797.3283149302006 800.4340126179159 854.9462586641312 847.851923853159 948.7364917993546 797.488209977746 998.0299204587936 894.2355394363403 897.9778617620468 943.7699049711227 996.8931704759598 836.7591418325901 797.5504549220204 1048.9013075828552 1047.9785829782486 997.7116912603378 896.9957709312439 996.1359083652496 995.4504102468491 896.8797206878662 996.7083364725113 846.6031432151794 846.7454828321934 945.3695595264435 898.3235910534859 897.0112532377243 1048.4543472528458 896.2596088647842 946.7255055904388 847.530360519886 896.1698368191719 798.5306048765779 798.5306588932872 1048.564451932907 1046.4435994625092 997.0890760421753 897.2558408975601 1032.2051376104355 1046.4985698461533 1045.860055088997 799.041480012238 944.7567790746689 998.2936859130859 847.0964498817921 946.1609601974487 896.8508124351501 798.562597669661 1048.6851066350937 799.0623919293284 840.2705669403076 897.2001850605011 944.6882039308548 948.0524688959122 1048.7985789775848 946.5438306331635 1046.4347779750824 898.8833084702492 996.1608827114105 897.740113735199 1047.2812980413437 896.6895297169685 799.2424799129367 1048.8964647054672 947.845670580864 797.8777738288045 1001.4165818691254 849.2945946753025 845.9987223148346 900.0928655266762 1047.1675872802734 947.9801088571548 943.8300907611847 799.4927989318967 1048.67582321167 847.5545898079872 842.9466851055622 1044.6775287389755 947.2191512584686 895.8912968635559 897.594827413559 1048.7021535634995 843.0005937814713 849.9487817287445 897.9048833251 897.3120927810669 948.3075767755508 943.850564956665 898.498061299324 809.8094856366515 895.3617542982101 846.4474894106388 1001.3857066631317 799.47205837816 905.7892292737961 946.9158232212067 947.6288437843323 798.4785811975598 895.8799719810486 947.6160734891891 )
set w_array = ( 5.258713617324829e-05 5.260303211212158e-05 5.2609895133972164e-05 5.140251064300537e-05 5.2601046371459956e-05 5.100838674306869e-05 5.100164143443108e-05 5.1833520317077635e-05 5.221248483657837e-05 5.2204768276214596e-05 5.139566788673401e-05 5.1398210954666135e-05 5.182581977844238e-05 5.184738063812256e-05 5.141276121139526e-05 5.140989894866943e-05 5.1403391695022583e-05 5.1098973858356476e-05 5.220410394668579e-05 5.1408815431594846e-05 5.1401488637924195e-05 5.137382478713989e-05 5.182288599014282e-05 5.21988971710205e-05 5.261068382263183e-05 5.2204727649688716e-05 5.1740379524230954e-05 5.2215226078033444e-05 5.141269435882568e-05 5.182193727493286e-05 5.183369464874267e-05 5.104545456171036e-05 5.261263847351074e-05 5.1800445461273194e-05 5.1799274826049806e-05 5.18227972984314e-05 5.108924515247345e-05 5.140199637413025e-05 5.1805194568634034e-05 5.2133478260040285e-05 5.1002001416683195e-05 5.256638708114624e-05 5.1415532970428467e-05 5.100656486749649e-05 5.0997577625513074e-05 5.140720109939575e-05 5.140461511611938e-05 5.180184125900269e-05 5.1415807819366455e-05 5.100504865646362e-05 5.259618806838989e-05 5.143258585929871e-05 5.2214443492889404e-05 5.180405702590942e-05 5.1833805656433104e-05 5.2207603740692134e-05 5.2197783756256105e-05 5.181601619720459e-05 5.140798687934875e-05 5.22185996055603e-05 5.260937042236328e-05 5.101528336405754e-05 5.2597524356842036e-05 5.100694925785065e-05 5.0982149803638455e-05 5.22119478225708e-05 5.137577214241028e-05 5.221837615966797e-05 5.099744896888733e-05 5.2614814376831055e-05 5.260006885528564e-05 5.221463441848755e-05 5.09976783156395e-05 5.1000371330976485e-05 5.2221338653564454e-05 5.2624180984497066e-05 5.100683879852295e-05 5.1802219581604e-05 5.221251268386841e-05 5.141061162948608e-05 5.101490441560745e-05 5.2610655403137204e-05 5.1397731924057e-05 5.2204278850555416e-05 5.2218744087219236e-05 5.1403407096862794e-05 5.261007671356201e-05 5.181194381713867e-05 5.2607729721069336e-05 5.1405311918258664e-05 5.262435874938965e-05 5.260335426330566e-05 5.147188754081726e-05 5.182024660110473e-05 5.14210636138916e-05 5.219830980300903e-05 5.261839027404785e-05 5.2219588756561275e-05 5.100156908035278e-05 5.180397386550903e-05 5.21836067199707e-05 5.260634841918945e-05 5.182176790237427e-05 5.22143666267395e-05 5.259600954055786e-05 5.1003364980220796e-05 5.26039981842041e-05 5.1002802276611326e-05 5.179434008598327e-05 5.2612867927551264e-05 5.221894102096558e-05 5.2601308822631835e-05 5.141357307434082e-05 5.141345963478088e-05 5.141774120330811e-05 5.220432729721069e-05 5.220926465988159e-05 5.182564363479614e-05 5.183455696105957e-05 5.2204155445098874e-05 5.2597256183624266e-05 5.221910152435303e-05 5.26040433883667e-05 5.220796022415161e-05 5.2214466190338136e-05 5.2199779129028316e-05 5.218405065536499e-05 5.185955934524536e-05 5.1412438201904296e-05 5.2618104171752926e-05 5.1008091914653775e-05 5.1406220293045045e-05 5.260388774871826e-05 5.099750501513481e-05 5.140491580963135e-05 5.10006603717804e-05 5.2206680393218994e-05 5.0997000354528425e-05 5.1001523590087894e-05 5.100920892357826e-05 5.1002786552906036e-05 5.220408945083618e-05 5.100672361254692e-05 5.142196192741394e-05 5.178678560256958e-05 5.2616679763793945e-05 5.260510101318359e-05 5.1799553966522214e-05 5.260299663543701e-05 5.180548524856567e-05 5.100343062877655e-05 5.0997814524173735e-05 5.2609498023986814e-05 5.182320499420166e-05 5.141160612106323e-05 5.2217731571197506e-05 5.140178108215332e-05 5.143328428268433e-05 5.181345043182373e-05 5.221237421035766e-05 5.1810237407684325e-05 5.100137101411819e-05 5.140165123939514e-05 5.100528927445412e-05 5.1405276250839234e-05 5.1006196796894074e-05 5.141415529251099e-05 5.261040649414062e-05 5.100160636305809e-05 5.10337928891182e-05 5.100517331957817e-05 5.2613433456420895e-05 5.2605167579650876e-05 5.221874017715454e-05 5.183425760269165e-05 5.1000273162126544e-05 5.141270270347595e-05 5.100089158415794e-05 5.22145016670227e-05 5.260002479553222e-05 )
set i = 180
let index = 1
repeat $i
    alter Ls = $ls_array[$&index]
    alter Ld = $ld_array[$&index]
    alter Lg = $lg_array[$&index]
    alter R0 = $r_array[$&index]
    alter @mn0[w] = $w_array[$&index]
    op
    sp lin 100 1k 100G 1
    let s21 = abs(S_2_1)
    let s12 = abs(S_1_2)
    let s22 = abs(S_2_2)
    let s11 = abs(S_1_1)
    let reals11 = real(minimum(S_1_1))

    let gmax = s21/s12
    let Gmax = vecmax(gmax)
    print Gmax >> ../out/Gmax-test.csv

    let gp = (s21*s21)/(1-s11*s11)
    let Gp = vecmax(gp)
    print Gp >> ../out/Gp-test.csv


    print reals11 >> ../out/s11-test.csv
    let nf = real(minimum(NF))
    print nf >> ../out/nf-test.csv
    set appendwrite

    print $ls_array[$&index] >> ../out/ls-test.csv
    print $ld_array[$&index] >> ../out/ld-test.csv
    print $lg_array[$&index] >> ../out/lg-test.csv
    print $r_array[$&index] >> ../out/r-test.csv
    print $w_array[$&index] >> ../out/w-test.csv

    let index = index + 1
end
.endc
.end