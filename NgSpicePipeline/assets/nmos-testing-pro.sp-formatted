nmos: cs amp

.include ../assets/45nm_CS.pm

.option TEMP=27C

V6 net2 0 dc 822.6m ac 1
Vdd net1 0 dc 1.2
R0 net1 out 500
mn0 out net2 0 0 NMOS W=5u L=45n

.control
set w_array = ( 1341.0396736860273 1136.3533359766004 1311.805468201637 1060.6514042615888 1171.118099093437 853.9450812339782 1298.6553543806074 759.2853367328644 1013.9453226327895 1094.9508351087568 1373.6006635427473 1441.0958081483839 1281.2243419885633 949.4945770502089 1440.352740883827 1292.6751470565794 1383.8972902297971 1273.5533350706098 1367.7267217636106 1001.4340388774871 1437.6250606775282 776.5114119648933 1135.5784088373182 1230.3973537683485 1438.6462587118147 1442.234254479408 1409.3976074457166 1312.3003846406934 1261.5132707357404 651.4195102825761 1256.1604654788969 1445.1777309179304 1249.509518742561 776.829342842102 801.8705612421036 756.9624352455139 1438.620038628578 1152.3543149232862 796.8639723956585 1357.813699841499 1439.3593955039976 720.8799707144499 625.8246314805001 690.1423464715481 1443.7477964162824 724.6733798086643 1437.0164579153059 1270.5973917245863 801.0630939900875 1337.801295518875 658.0800050869584 1439.3416351079939 1435.6730002164838 1439.5420950651167 854.6136438846587 1441.0661250352857 1438.7855714559553 1061.2532788515089 1442.950409054756 1300.0427430868147 767.7010434865952 828.9135593175888 890.0936710834502 680.2728845179081 919.4157633185386 1022.1916130185126 1245.7987338304517 1436.5161490440366 1395.5923378467558 903.5357183218001 1126.8027943372724 1140.6067281961439 1445.6350487470625 1159.826098680496 1132.3436421155927 1113.1767612695692 1444.1758763790128 1293.4157902002332 1437.3163563013075 1439.1721445322034 980.4317769408225 1153.534070253372 897.898153066635 1207.0587587356565 851.9153004884719 979.1323244571685 1440.4958629608152 1090.506481528282 1376.0056883096693 1054.0304374694822 1437.4603193998335 1111.8431979417799 863.6820328235625 806.7223155498505 1204.5110076665876 661.5900393947959 1443.237147927284 920.3308689594268 772.859003841877 1444.8450326919553 1218.694786429405 1064.2205017805097 734.0019536018372 973.1070977449416 1044.0328681468961 763.7059685587883 1439.0856182575224 871.3609552383422 1368.8273715972898 1007.2821068763732 1367.8978943824766 758.377750813961 1190.6370216608045 1307.055576443672 825.0896817445755 1070.6140464544294 1319.23435986042 854.3624258041381 1031.1614292860029 736.8551933765411 1291.6846215724943 1387.7988880872724 1440.5138212442396 1069.3207532167432 697.8439579159021 1210.1670259237287 1410.6919890642164 1421.6274458169935 892.853235900402 1071.2516891956327 1006.4714857935904 1123.5791093111036 1396.416291594505 1439.778075814247 934.0318518877028 1441.01145863533 1439.4271224737165 1213.284395933151 1010.1810586452483 1178.1481486558912 1332.8608381748197 766.5183940529823 1069.1899496316908 1438.497843146324 869.3734729290007 1055.731626152992 1436.7883926630018 914.9147644639014 678.5491614043713 978.9386916160582 949.4003084301947 1254.78074491024 1100.431178808212 1214.5267331600187 1075.8001810312269 850.0429391860961 1229.3149095773695 1206.881402134895 1444.8036247491834 1437.6598888635633 1115.9149789810178 1439.4972735643385 787.1928802132607 1443.649396896362 825.6303349137306 828.6164808273315 1441.9945138692854 1392.1367782354353 1263.1017130613325 1445.2831059694288 847.2665786743163 1090.904235243797 1316.632140278816 1370.977171063423 1438.653630018234 1196.9068866968153 1367.2588664293287 727.4808210134506 614.9453020934016 1269.529393315315 813.523211479187 1369.78316783905 1440.255083441734 1187.4951630830762 1440.3434401750562 1285.6308990716932 1221.8225950002668 1009.6254897117614 1268.3790737390516 1240.2419066429136 873.1589603424071 1014.1976290941237 1228.2182174921033 1122.1310681104658 1175.3370589017866 1374.694189429283 1437.4066919088361 673.2369045168161 1440.758014321327 1444.3329495191572 1253.6849433183668 1149.4566494226453 1445.0506377220152 1347.8331488370893 1223.9311844110487 1376.9572299718855 1140.54201900959 1441.0372334718702 735.9564629197121 1414.152149558067 751.8780395388603 1445.4458189010618 688.1771017611027 808.3417272567749 913.4433230757712 1042.9247975349424 1437.243632674217 1295.6425184011457 1169.8066002130506 1345.290691256523 1440.8011043071745 1324.6201628446577 854.2317458987235 1440.6131112575529 718.2528791576624 1316.0407537221906 922.6970088481902 1156.9064182043073 860.7316303253173 681.6495749354362 1267.8267699480054 853.2949715852736 1175.4329353570936 1436.4029079675672 1075.5658823251722 957.9711836576461 674.7593204677105 1440.2240151166914 1387.785431742668 1126.4948815107343 1438.561958670616 672.9945542663336 1172.186641693115 986.2265390157698 1444.1830992698667 1442.1157693862913 1179.7859638929365 763.7969844043255 992.2785794734954 1342.1787631511686 1218.2812017202375 1365.771544575691 873.9361631870269 1444.2811030149458 826.0007059574127 1332.2815722227094 769.0195178985596 1440.6245392560957 836.5201291441916 1090.2358704805372 1445.0432169437406 734.5913860201836 1440.4845339059827 1256.346825957298 1188.9201009273527 699.2749684303999 1445.8071118593214 1247.8560703992841 1191.9785994291303 715.2938067167997 927.885493338108 649.3576161190867 1437.930203080177 737.0222598314285 1305.268751978874 889.7437071800231 959.3996340036391 1364.5525580644605 1304.8005008697507 1441.4625924825666 1332.5685584545133 783.2729159295559 1064.771618247032 925.4562273621558 1290.2608215808866 1445.3350514173505 677.2208482772112 1201.8589699268339 1284.6719861030576 1150.8987045288084 1393.8495433330534 795.2347034215927 771.2824842333794 901.4846646785735 783.575090020895 1441.2878578901289 993.446214199066 767.6720529794693 1437.4451810121534 808.5610483586788 1298.6296290159223 1219.5299208164213 905.1438999176024 683.0402906239033 987.734416425228 984.2105609178542 1134.5767027139661 1441.1568069458006 1294.6527844667432 1197.5542259216306 1265.190563201904 1439.4821846485136 1439.2065769433973 750.5713394284248 1382.474232316017 1436.790272593498 792.7280634641647 801.6185887157917 )
set r_array = ( 6.482644443511962e-06 6.472213869094848e-06 6.484234886169433e-06 6.471504478454589e-06 6.476978330612182e-06 6.398759107589721e-06 6.483614330291747e-06 6.301737384796142e-06 6.472980766296386e-06 6.468584518432616e-06 6.483808307647704e-06 5.1746175813674926e-06 6.482913522720336e-06 6.4605992603302e-06 4.853754358291626e-06 6.483772258758545e-06 6.484676914215087e-06 6.482167224884032e-06 6.47767141342163e-06 6.466788940429687e-06 4.254866116046905e-06 6.2531726646423335e-06 6.444128351211547e-06 6.478632287979125e-06 3.6690425384044645e-06 6.462857036590576e-06 6.483090763092041e-06 6.484403114318847e-06 6.4808192539215084e-06 5.85997498512268e-06 6.481230382919311e-06 6.073637180328369e-06 6.4796420860290526e-06 6.471810894012451e-06 6.460179119110107e-06 6.477970533370971e-06 3.868709235191345e-06 6.470726852416992e-06 6.409054713249206e-06 6.479575996398925e-06 5.582044057846069e-06 6.084666423797607e-06 6.110143976211547e-06 6.099854593276977e-06 6.112784557342529e-06 6.2339744853973385e-06 4.412484197616577e-06 6.4818921375274655e-06 6.301759271621703e-06 6.48212173461914e-06 6.059516100883483e-06 5.614105038642883e-06 3.4718386995792386e-06 5.337604265213012e-06 6.449646835327148e-06 4.918027811050415e-06 6.4853463935852045e-06 6.47391975402832e-06 6.275792484283446e-06 6.485798721313476e-06 6.329806594848632e-06 6.409963874816894e-06 6.422087030410766e-06 6.096096067428589e-06 6.455786304473876e-06 6.472816400527953e-06 6.4808008003234855e-06 4.27468560218811e-06 6.4833675670623774e-06 6.066999034881591e-06 6.38718183517456e-06 6.46741807937622e-06 6.448337059020996e-06 6.4761337566375725e-06 6.470500259399414e-06 6.469831209182738e-06 6.147839097976684e-06 6.485881118774414e-06 4.098416726589202e-06 4.687434225082397e-06 6.468345050811767e-06 6.475469856262207e-06 6.440071992874145e-06 6.477898864746093e-06 6.444284992218017e-06 6.467559270858764e-06 4.729362516403198e-06 6.456528739929199e-06 6.485807304382324e-06 6.475084047317505e-06 4.025127403736114e-06 6.470739727020263e-06 6.5036485004425045e-06 6.269297032356262e-06 6.476934986114501e-06 6.457138996124267e-06 6.188256769180298e-06 6.460806112289428e-06 6.085246210098266e-06 6.393666987419128e-06 6.479057579040527e-06 6.471251277923583e-06 6.4712632942199705e-06 6.464832429885864e-06 6.469533805847167e-06 6.281101112365722e-06 5.474086217880249e-06 6.3550009059906e-06 6.4793408203124995e-06 6.404534654617309e-06 6.476592092514038e-06 6.0963248062133786e-06 6.477698879241943e-06 6.485101776123046e-06 6.518833236694335e-06 6.464897661209106e-06 6.484428434371948e-06 6.445992164611816e-06 6.46868064880371e-06 6.167624788284301e-06 6.483987264633178e-06 6.480672912597656e-06 5.5806353616714475e-06 6.460289840698242e-06 6.139071278572082e-06 6.4767796325683585e-06 6.48629653930664e-06 6.47848895072937e-06 6.369223909378051e-06 6.469365148544311e-06 6.471125965118407e-06 6.4675601291656485e-06 6.484621982574462e-06 4.630399303436279e-06 6.4649354267120355e-06 4.954327111244201e-06 4.58039541721344e-06 6.478809099197387e-06 6.471488170623779e-06 6.477187328338623e-06 6.480554466247558e-06 6.2505041885375975e-06 6.471811323165893e-06 4.62190034866333e-06 6.460867481231689e-06 6.473382453918457e-06 4.410481123924255e-06 6.468354921340942e-06 6.492351465225219e-06 6.465722494125365e-06 6.4648972320556635e-06 6.480151920318603e-06 6.46340721130371e-06 6.477395467758178e-06 6.476336317062378e-06 6.444948892593383e-06 6.478227596282959e-06 6.4778722572326654e-06 6.288947324752807e-06 6.483849077224731e-06 6.376625089645385e-06 5.379340295791626e-06 6.371344356536865e-06 6.143272047042846e-06 6.440455656051635e-06 6.46555941581726e-06 6.4470884370803825e-06 6.48433874130249e-06 6.481875400543213e-06 6.005701332092284e-06 6.307456712722778e-06 6.467611198425293e-06 6.483177881240844e-06 6.4844786453247065e-06 5.546649627685546e-06 6.478205280303954e-06 6.476005439758301e-06 6.30437903881073e-06 6.449703912734985e-06 6.483247833251953e-06 6.377983360290527e-06 6.481901149749755e-06 5.209333305358886e-06 6.474934272766113e-06 4.72053783416748e-06 6.48346713066101e-06 6.478428010940552e-06 6.471496753692627e-06 6.4834452438354484e-06 6.480568199157714e-06 6.463616209030151e-06 6.470138912200927e-06 6.4786850738525385e-06 6.468114595413208e-06 6.474597816467285e-06 6.480685358047485e-06 4.492124991416931e-06 5.887195329666137e-06 5.177080278396606e-06 6.0722544479370115e-06 6.480647163391113e-06 6.472581224441528e-06 6.34376781463623e-06 6.47604148864746e-06 6.478875188827514e-06 6.4829688835144034e-06 6.4671558666229244e-06 5.250531392097473e-06 6.264561967849731e-06 6.4672859001159664e-06 6.477830629348754e-06 6.176011519432067e-06 6.067529039382934e-06 6.425755004882812e-06 6.420899991989135e-06 6.472303133010863e-06 4.487794189453125e-06 6.485789709091186e-06 6.4415873336791984e-06 6.477983837127685e-06 4.891966180801391e-06 6.4821054267883295e-06 6.269653658866882e-06 4.790884237289428e-06 6.092262868881225e-06 6.483667974472045e-06 6.44481692790985e-06 6.471049575805663e-06 6.413284664154052e-06 6.253133611679077e-06 6.481970672607421e-06 6.449789743423462e-06 6.44710238456726e-06 4.339852230548858e-06 6.4774285125732415e-06 6.452204160690307e-06 6.24973214149475e-06 5.24982135772705e-06 6.480617980957031e-06 6.472344331741332e-06 3.817522280216217e-06 6.093274812698364e-06 6.473225812911987e-06 6.467832641601562e-06 6.377122478485107e-06 5.685707788467407e-06 6.476379661560058e-06 6.242497901916503e-06 6.470956878662109e-06 6.475571994781494e-06 6.478343467712402e-06 6.481351833343505e-06 6.430624823570251e-06 6.214209179878234e-06 6.410394744873046e-06 6.47929962158203e-06 6.197486143112182e-06 5.200466351509094e-06 6.427592639923095e-06 6.47233660697937e-06 6.2108001995086665e-06 6.235599045753478e-06 5.1150113868713375e-06 6.482268934249877e-06 6.47562177658081e-06 6.249113945960998e-06 6.439184074401855e-06 6.480036048889159e-06 6.460464935302734e-06 6.358948044776916e-06 6.46528561592102e-06 6.043793420791625e-06 3.975857369899749e-06 6.2658633756637564e-06 6.485405187606811e-06 6.450863914489746e-06 6.455564432144164e-06 6.479860525131225e-06 6.486069087982177e-06 5.784855966567992e-06 6.482907085418701e-06 6.379842882156371e-06 6.463000373840331e-06 6.479843788146972e-06 6.484315567016601e-06 6.261082391738891e-06 6.2444194364547725e-06 6.476653461456298e-06 6.483428077697753e-06 6.476031188964843e-06 6.484468345642089e-06 6.3697584199905386e-06 6.313357787132262e-06 6.454776935577392e-06 6.487163429260253e-06 5.766866283416747e-06 6.470341472625732e-06 6.4730271148681635e-06 4.407547752857208e-06 6.295338063240051e-06 6.486039905548095e-06 6.477749519348144e-06 6.465317373275757e-06 6.488664608001708e-06 6.449478178024291e-06 6.469108085632324e-06 6.467600040435791e-06 6.452575807571411e-06 6.484985046386718e-06 6.476271514892578e-06 6.481562118530273e-06 4.718773369789123e-06 4.697222142219543e-06 6.361388854980468e-06 6.483685569763183e-06 4.140253071784973e-06 6.247091131210327e-06 6.1968625831603995e-06 )
set i = 318
let index = 1
repeat $i
    let r_test = $r_array[$&index]
    alter @mn0[w] = $w_array[$&index]
    alter R0 = r_test
    op
    let gm = @mn0[gm]
    let ro = 1/@mn0[gds]
    let a0 = gm*r_test
    let id = @mn0[id]
    let pw = id*1.2
    let cgd = @mn0[cgd]
    let cdb = abs(@mn0[cdb])
    let cp = (1+a0)*cgd+cdb
    let bw = 1/(2*pi*r_test*cp)
    wrdata ../out/r-test.csv $r_array[$&index]
    wrdata ../out/w-test.csv $w_array[$&index]
    wrdata ../out/bw-test.csv bw
    wrdata ../out/pw-test.csv pw
    wrdata ../out/a0-test.csv a0
    set appendwrite
    let index = index + 1
end

.endc

.end

