nmos: cs amp

.include ../assets/45nm_CS.pm

.option TEMP=27C

V6 net2 0 dc 822.6m ac 1
Vdd net1 0 dc 1.2
R0 net1 out 500
mn0 out net2 0 0 NMOS W=5u L=45n

.control
set w_array = ( 1299.3568462133408 1422.5062173604965 810.2928210794926 1419.8173922300339 907.0493426918983 1013.5852855443954 1232.9177868366241 1340.7697689533234 898.3629819750786 966.7561110854149 1012.8114369511604 875.8204680681229 859.9274364113808 1095.3846272826195 1218.9905774593353 1434.4463121891022 775.7221051305532 770.7618792355061 1139.2225575447083 1424.2220890522003 1151.9736272096634 1197.9217541217804 1432.2249335050583 1438.919950723648 1265.5238237977028 943.1338873505592 1387.9426193237305 1363.1666791439056 1185.9987226128578 990.4131007194519 1429.4253689050674 1400.9931576251984 1073.990863263607 1415.3916981816292 851.4028084278107 1427.4158310890198 982.8152765333652 1050.2077919244766 1341.6027736663818 1092.0063358545303 679.4679679721594 959.0861734747887 1427.8461021184921 1155.5034232139587 1428.9895904064178 1069.4615599513054 975.4744102060795 1430.3551477193832 732.717105820775 1436.1093711853027 934.6963462233543 741.9754934310913 897.7789689600468 1000.2820920944214 669.7049861587584 931.1215069890022 1217.1106618642807 1021.907268166542 802.9508975148201 1296.6476139426231 1436.6884422302246 1197.3655980825424 752.8699804842472 1160.6009793281555 1320.3048494458199 975.3180374205112 1113.931668996811 1085.8489853143692 1376.5991505980492 1421.500317454338 721.6165189445019 990.2819786965847 1134.1635045409203 833.6708721518517 965.2014312148094 1282.6223027706146 1202.2726547718048 1431.2732231616974 624.4523677788675 1060.7180100679398 854.5495894551277 1351.728944182396 1412.369818687439 918.5291212797165 )
set r_array = ( 6.6479761648178095e-06 6.205151503086089e-06 6.305881639122963e-06 6.269775529503822e-06 6.563956861495971e-06 6.634647374153137e-06 6.625941817760467e-06 6.640953694581985e-06 6.381886278390884e-06 6.618819658756256e-06 6.4900935190916056e-06 6.311978076696395e-06 6.232644592523574e-06 6.654700462818145e-06 6.632250373363494e-06 6.4519795525074004e-06 5.729176973104477e-06 5.920690720081329e-06 6.645715956687927e-06 5.409686987400055e-06 6.643972073793411e-06 6.638242428302765e-06 5.7635065662860865e-06 6.538904135227203e-06 6.632708584070205e-06 6.61143196105957e-06 6.662628625631332e-06 6.661006783246994e-06 6.636604045629501e-06 6.620212172269821e-06 3.6803340102732177e-06 6.645657842159271e-06 6.656119351387024e-06 6.651679401397704e-06 6.464009483456611e-06 4.34706786006689e-06 6.65998486161232e-06 6.625593130588531e-06 6.652075921297073e-06 6.65934917807579e-06 5.41048226237297e-06 6.368422259688377e-06 4.4480787339806554e-06 6.645213936567306e-06 6.666427974700928e-06 6.659803812503814e-06 6.617315833568573e-06 5.78299080312252e-06 6.102821205854416e-06 5.240482290387153e-06 6.536414598226547e-06 5.535222192406654e-06 6.314481471776962e-06 6.458404784202575e-06 6.631996904611587e-06 6.23940197110176e-06 6.62884083867073e-06 6.663815950155258e-06 6.068589513301849e-06 6.632757310867309e-06 3.919011664688587e-06 6.635965232849121e-06 5.836140339374542e-06 6.641260807514191e-06 6.636356388330459e-06 6.389985655546188e-06 6.648995404243469e-06 6.6060440737009046e-06 6.645444159507751e-06 6.652595822811126e-06 6.1146182316541665e-06 6.656316493749618e-06 6.653843050003052e-06 6.141443227529526e-06 6.642712776660919e-06 6.631229792833328e-06 6.634412233829498e-06 4.081953180134296e-06 6.610903565883636e-06 6.5866550552845e-06 6.310620431900024e-06 6.645205889940262e-06 6.008567487001419e-06 6.305836488604545e-06 )
set i = 84
let index = 1
repeat $i
    let r_test = $r_array[$&index]
    alter @mn0[w] = $w_array[$&index]
    alter R0 = r_test
    op
    let gm = @mn0[gm]
    let ro = 1/@mn0[gds]
    let a0 = gm*r_test
    let id = @mn0[id]
    let pw = id*1.2
    let cgd = @mn0[cgd]
    let cdb = abs(@mn0[cdb])
    let cp = (1+a0)*cgd+cdb
    let bw = 1/(2*pi*r_test*cp)
    wrdata ../out/r-test.csv $r_array[$&index]
    wrdata ../out/w-test.csv $w_array[$&index]
    wrdata ../out/bw-test.csv bw
    wrdata ../out/pw-test.csv pw
    wrdata ../out/a0-test.csv a0
    set appendwrite
    let index = index + 1
end

.endc

.end

