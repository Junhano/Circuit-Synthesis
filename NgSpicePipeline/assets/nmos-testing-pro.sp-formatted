nmos: cs amp

.include ../assets/45nm_CS.pm

.option TEMP=27C

V6 net2 0 dc 822.6m ac 1
Vdd net1 0 dc 1.2
R0 net1 out 500
mn0 out net2 0 0 NMOS W=5u L=45n

.control
set w_array = ( 1355.7856377959251 1323.3974409103394 1409.3051087856293 686.2914210930467 1191.5019136667252 1234.1772270202637 960.0221236050129 1069.2044791579247 1080.6178730726242 675.4755691438913 829.6343643963337 1268.6344128847122 1311.5340572595596 1177.9112499952316 741.2085168808699 1212.459899187088 992.5014887750149 654.3614690005779 829.7358345985413 1440.1193004846573 817.4993199110031 1384.421084523201 1320.6881594657898 840.460844039917 1363.4781461954117 1383.3909910917282 1343.7681925296783 1112.8972482681274 1201.371396780014 1135.9760519862175 1025.6046731770039 981.6273105144501 762.5150834023952 970.9597852826118 1067.9110598564148 1036.665269434452 631.3328164443374 1417.1999675035477 1421.694455742836 1224.1375532746315 1157.486456334591 1418.7478613853455 1343.6735820770264 1124.145123064518 1289.8830157518387 1190.2300816774368 1406.8544325232506 1398.885567188263 664.7042625397444 1434.978864789009 1046.1222332715988 828.2283616065979 730.0166019052267 664.7538850829005 707.9207953810692 1396.5147000551224 1002.9709909856319 1047.5632232427597 939.3486578762531 1268.9333897829056 1102.4168294668198 665.1166711747646 664.5958096534014 840.5898761749268 1377.8218579292297 1135.975658595562 1213.197014927864 1191.4992582798004 905.9703950583935 642.1433576196432 1014.7407968342304 981.1524634063244 894.9228790402412 707.6060398295522 1090.3434243798256 1398.8792237639427 960.0755263864994 1425.126740038395 1235.8415645360947 981.2375341355801 894.5673030614853 1014.3075262010098 729.823139756918 774.742918908596 )
set r_array = ( 5.535549198389053e-06 4.394552682638168e-06 4.774206404685974e-06 3.6362972232699392e-06 4.780804638862609e-06 6.281289135217666e-06 5.151810248494148e-06 4.781018992066383e-06 5.542389725446701e-06 4.771796439886093e-06 4.01787442445755e-06 4.393583958148956e-06 5.911270354986191e-06 3.633410942852497e-06 4.014156435728073e-06 2.9074295546114444e-06 4.77651221036911e-06 3.6367923143506046e-06 4.391935517191886e-06 4.771719102859497e-06 6.2795005488395685e-06 3.6462850432097908e-06 6.2712938833236694e-06 3.2752484205365178e-06 3.6471708427369592e-06 3.2734081457555293e-06 5.907276545763015e-06 2.8960808488726613e-06 6.283295874595642e-06 5.166275625228882e-06 5.536330615282058e-06 4.775664408802986e-06 6.652460371255874e-06 5.529655938148498e-06 3.262271949201822e-06 5.910698373913765e-06 5.5164862918853756e-06 5.896090840101242e-06 2.8547297354042528e-06 5.918648888468742e-06 6.284227942228317e-06 4.394140404760838e-06 4.0177157270908355e-06 4.3960151571035385e-06 2.9120440158247944e-06 2.9046951542794704e-06 4.017913316488266e-06 5.15461963891983e-06 2.8750998835265634e-06 3.636555888801813e-06 3.637198110222816e-06 6.6512408602237695e-06 6.279835377931594e-06 6.649918531179428e-06 3.6367094452679154e-06 4.018432212173938e-06 3.266948939412832e-06 5.538953368663788e-06 2.8994750167429444e-06 5.543241773843765e-06 6.639982287883758e-06 3.259006331786513e-06 4.0134712430834765e-06 4.0182646858692166e-06 5.1563404995203016e-06 5.5460417765378946e-06 4.39369996368885e-06 5.546672766208648e-06 3.2751046429574487e-06 6.656198029518127e-06 5.908203919529915e-06 3.642670878320932e-06 3.647165645956993e-06 3.2601008127629754e-06 4.013385859429836e-06 4.774787549972534e-06 5.90270159125328e-06 6.252237458825111e-06 5.545217444300651e-06 4.018710156083107e-06 5.900167127251624e-06 4.778108124732971e-06 3.6379243183135985e-06 4.769337748289108e-06 )
set i = 84
let index = 1
repeat $i
    let r_test = $r_array[$&index]
    alter @mn0[w] = $w_array[$&index]
    alter R0 = r_test
    op
    let gm = @mn0[gm]
    let ro = 1/@mn0[gds]
    let a0 = gm*r_test
    let id = @mn0[id]
    let pw = id*1.2
    let cgd = @mn0[cgd]
    let cdb = abs(@mn0[cdb])
    let cp = (1+a0)*cgd+cdb
    let bw = 1/(2*pi*r_test*cp)
    wrdata ../out/r-test.csv $r_array[$&index]
    wrdata ../out/w-test.csv $w_array[$&index]
    wrdata ../out/bw-test.csv bw
    wrdata ../out/pw-test.csv pw
    wrdata ../out/a0-test.csv a0
    set appendwrite
    let index = index + 1
end

.endc

.end

