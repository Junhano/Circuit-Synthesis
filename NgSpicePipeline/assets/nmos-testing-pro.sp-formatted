nmos: cs amp

.include ../assets/45nm_CS.pm

.option TEMP=27C

V6 net2 0 dc 822.6m ac 1
Vdd net1 0 dc 1.2
R0 net1 out 500
mn0 out net2 0 0 NMOS W=5u L=45n

.control
set w_array = ( 939.5027464628218 1445.3147184848783 1442.952536344528 1073.07759642601 1096.2775218486784 1307.885763645172 1410.4522979259489 1082.8476446866987 1444.049228429794 724.4978907704353 790.8275403082371 839.6301525831221 1185.2220302820203 1218.2685863971708 1329.1930937767027 1091.1136001348493 1089.9219715595243 1390.8839035034177 740.0124748051167 980.5884790420531 760.378565788269 1362.1607422828672 802.8573887050152 1215.4862397909162 831.2593168020247 1444.6208757162092 1446.6313129663465 1441.78722679615 1195.2841603755949 1440.4565823078153 1441.2947344779966 1442.7014666795728 931.3820898532866 1440.0851476192472 1440.8831286430357 769.3290880322456 1044.1349285840986 875.6591689586638 1439.5301723480222 1102.3379230499265 1444.3121218681333 889.7275298833846 732.9235908389091 1200.7877063751218 1170.4501301050184 1344.6126794815061 798.181494474411 1446.724913716316 1442.0867788791654 1362.651849389076 1445.5748414993284 1221.00546836853 729.9960567057133 1440.141050815582 1428.854146003723 1179.7123992443082 1445.3074955940244 982.2197145223616 1068.723331093788 1445.131969451904 1343.9851784706113 1043.3425378799436 1421.718325614929 1438.4690010547636 1443.2555019855497 1183.5008549690244 1164.6296674013136 664.9267768859863 971.4366805553435 918.4155166149138 1445.303438901901 869.9932068586348 1336.8208622932432 812.1881887316704 1442.0351302623747 849.1216248273848 1440.680590867996 872.8366512060164 844.8000109195708 1217.875483036041 646.3983179628849 875.2924340963363 1066.228218078613 1032.9429107904432 877.9870671033858 1152.4654781818388 1296.9628727436063 906.9595170021056 1332.1715962886808 1258.5980427265165 847.1185588836669 1021.6147959232329 1347.7346009016035 1444.809858202934 1298.7325799465177 1392.4390017986295 1405.623548030853 1440.6453669071195 1381.3041734695432 987.6316881179808 1139.8159205913541 821.4734004437923 1443.6684930324552 842.2932720184325 1432.6948440074918 1298.539392352104 723.4478568285704 1440.624044537544 751.8071711063385 1446.910581588745 737.0918172597885 868.8448166847228 775.678293555975 1444.4513851404188 1049.2870265245435 1185.9757339954374 741.0663366317749 1013.5812592506408 1017.9550659656524 855.9714484214782 1439.8699450492857 914.0811884403228 1158.8464075326917 1437.6517260074613 1041.3311606645582 941.4006847143172 922.7391093969344 1038.9574515819547 1278.9068329334257 949.7614777088164 850.8832681179045 1342.9792177677152 1425.161665678024 794.3340311944485 1267.7058607339857 1229.7401201725004 809.606277346611 1289.0038406848905 706.4284317195415 1440.9017300605772 721.9619016349316 640.4814995452762 1443.555301427841 1334.8822087049482 1408.8217055797575 1121.5676331520078 884.2900040745734 1302.8859895467756 1155.0018012523649 1439.8947799205778 1440.913504362106 1441.0490572452543 951.5764516592025 886.284635066986 1301.7268145084379 1051.016809940338 983.941335082054 1351.8094491958616 639.6361894160509 1008.2387441396712 1274.077192544937 1445.712620615959 1445.3216940164564 1308.93466591835 825.882394015789 1440.5377161502836 873.367929458618 1439.5024681091306 1431.7143118381498 1257.6043015718458 1441.149386167526 1158.3909201622007 1441.6484582424162 725.0745223462582 680.7323234528303 815.6857623159885 695.4985529184341 823.426920324564 832.5810563564299 679.5512694865465 1285.0376820564268 1443.217210769653 1345.6109225749967 1443.2760328054426 1086.036699414253 1440.7405507564542 1253.6449205875394 1441.3280290365217 1447.726619839668 872.7462661266326 1402.4208390712736 635.6100399792194 1225.0725990533826 1445.1798087358472 1103.1965070962904 938.6927437782286 1220.217282772064 1437.4114412069318 891.999920606613 1441.7187082767484 674.9492058157921 855.3521102666854 1444.523712992668 1023.4060728549956 1268.2572245597837 1445.6511270999906 855.4583263397216 1439.7474527359007 1280.0647711753843 1435.9680008888242 1167.713495492935 1435.664886832237 1441.3222408294675 1148.4396564960477 1442.2985184192655 1427.7022433280943 705.3742545098066 1413.5204929113386 1446.5918838977811 1300.1694405078886 856.2459677457808 1100.3262984752653 1320.3235816955564 1128.0589342117307 1357.8228026628492 1444.4598448276518 1357.0525258779523 1070.3177100419996 1248.4615564346311 1120.9426057338712 1008.2569497823714 906.0687762498854 1102.7885127067564 991.4331054687499 734.092870503664 1280.6523978710172 1051.2937533855436 968.6250466108321 698.6995550990105 1386.6895806789396 726.2245574593544 998.8634318113326 701.9588227570057 688.7040512263775 808.2441811263561 991.394121646881 1418.2120573520658 1440.300449132919 1044.1440314054487 1434.8973804712293 1441.4459204673765 1135.7333052158353 1160.665091872215 761.6781666874886 1439.3868029117582 1441.5000426769254 1294.892525076866 913.0794328451155 1333.1148266792295 1440.9217661619184 947.3563045263289 968.6592811346053 1027.4882429838178 1442.0320630073545 1082.4912494421003 1440.7644951343534 1263.6150825023649 1281.178877353668 863.2604831457137 981.1567622423171 845.1020118594168 1364.106866121292 1264.2953699827192 1172.0388197898862 1161.957445144653 880.5945801734923 679.9881307035685 1089.3161392211912 1330.3619652986524 726.9927564263344 1445.0486588478086 682.1158038824797 1017.8298527002333 1086.3013738393781 1050.4539191722868 989.8014247417449 761.5676218271255 760.7835176587105 832.6498717069625 943.6391377449035 879.3249344825743 700.4325541853905 1206.5955042839048 769.733866751194 797.9786722362041 845.8857202529906 1446.0635244846342 801.264048665762 1098.8701933622358 965.6832027435302 1446.2605214118955 977.5502640008925 708.955924063921 1441.30329310894 813.6384685337543 1437.3646903038023 1444.2667067050932 1288.7000834941862 1227.0572614669798 928.8925671577452 1117.5312244892118 749.5467773079872 1019.4329386949538 1386.3193827867506 981.125594973564 950.7323133945464 1416.791868805885 1441.9998073577879 778.446355164051 964.3964397907256 )
set r_array = ( 6.465013961791992e-06 4.55997350692749e-06 4.933845119476318e-06 6.474630861282348e-06 6.472067956924438e-06 6.475246696472168e-06 6.5056286144256585e-06 6.469173746109008e-06 5.955389957427978e-06 6.222489051818847e-06 6.3266355800628655e-06 6.393303279876709e-06 6.472984199523925e-06 6.469569425582885e-06 6.47953179359436e-06 6.471879129409789e-06 6.472423295974731e-06 6.501358108520507e-06 6.25815728187561e-06 6.482276229858398e-06 6.290743331909179e-06 6.472913389205932e-06 6.345347528457641e-06 6.473592309951781e-06 6.370122556686401e-06 5.838694338798523e-06 6.068406658172607e-06 5.640190916061401e-06 6.4680957126617424e-06 5.380918292999267e-06 5.8156076002120965e-06 3.915273027420044e-06 6.443891887664794e-06 5.458163337707519e-06 5.483979063034057e-06 6.291093950271606e-06 6.471107940673828e-06 6.447236280441283e-06 3.640830473899841e-06 6.468702535629272e-06 4.105481343269348e-06 6.422874526977539e-06 6.246586661338806e-06 6.465847806930541e-06 6.46067307472229e-06 6.475016241073608e-06 6.341165857315063e-06 6.302784948348999e-06 5.0305196571350094e-06 6.471168022155761e-06 4.336007766723632e-06 6.480199127197265e-06 6.223600988388061e-06 5.660289888381957e-06 6.485964803695678e-06 6.469425659179687e-06 4.612873535156249e-06 6.470781784057617e-06 6.468761758804321e-06 4.608064227104187e-06 6.470135908126831e-06 6.479160575866699e-06 6.499193887710571e-06 6.456433897018432e-06 5.877718977928161e-06 6.46751893043518e-06 6.465983419418334e-06 6.220525674819945e-06 6.483041410446167e-06 6.445143728256225e-06 6.011126689910888e-06 6.415607242584228e-06 6.473729209899902e-06 6.359082155227661e-06 5.046976404190063e-06 6.389762120246886e-06 5.289601521492004e-06 6.412829761505126e-06 6.413269643783568e-06 6.481380586624145e-06 6.253439598083495e-06 6.419949417114257e-06 6.466986351013183e-06 6.481111078262329e-06 6.416865091323852e-06 6.4666215705871575e-06 6.487129096984863e-06 6.46651213645935e-06 6.47879879951477e-06 6.480385808944702e-06 6.389973049163818e-06 6.475496034622192e-06 6.474014596939086e-06 5.8943270015716545e-06 6.486882333755492e-06 6.483674840927124e-06 6.4924021053314205e-06 5.516255693435668e-06 6.494195966720581e-06 6.471580438613891e-06 6.466255502700805e-06 6.3629110622406e-06 5.862278680801391e-06 6.409755735397338e-06 6.4587066936492915e-06 6.48567512512207e-06 6.247383813858032e-06 5.2798578071594234e-06 6.283236150741577e-06 6.0560200023651115e-06 6.2662013339996334e-06 6.417295961380004e-06 6.305315237045287e-06 4.133601193428039e-06 6.47529948234558e-06 6.459338836669921e-06 6.244943218231201e-06 6.472186403274536e-06 6.470823411941527e-06 6.421095685958861e-06 3.6602165150642394e-06 6.4402771282196035e-06 6.464217882156372e-06 3.465477519035339e-06 6.467432241439819e-06 6.448156385421752e-06 6.452667646408081e-06 6.477573566436767e-06 6.483659391403198e-06 6.463196067810058e-06 6.413452463150024e-06 6.471834068298339e-06 6.4855159091949455e-06 6.332018022537231e-06 6.473700885772704e-06 6.471614770889281e-06 6.358849983215332e-06 6.487017946243285e-06 6.221968488693237e-06 5.1699943113327025e-06 6.254570846557617e-06 6.260722761154174e-06 5.949988417625427e-06 6.47744095802307e-06 6.505375413894652e-06 6.469205074310302e-06 6.432469110488891e-06 6.486504678726196e-06 6.462867336273192e-06 5.38118007659912e-06 5.231500368118286e-06 5.201339893341064e-06 6.47131178855896e-06 6.418059425354003e-06 6.473698740005493e-06 6.477220373153686e-06 6.480873756408691e-06 6.47284815788269e-06 6.266283731460571e-06 6.483373575210571e-06 6.483128099441528e-06 4.415128426551818e-06 4.285000519752502e-06 6.4815840053558345e-06 6.375082926750183e-06 3.7138772714138027e-06 6.423873596191406e-06 2.863786341547966e-06 6.481577997207641e-06 6.485173015594482e-06 5.177140789031982e-06 6.465822057723999e-06 5.093991236686706e-06 6.228704266548156e-06 6.246518640518188e-06 6.369665293693542e-06 6.247069244384765e-06 6.379850606918335e-06 6.396007804870605e-06 6.25051727771759e-06 6.485382871627807e-06 4.921046047210693e-06 6.467450265884399e-06 3.9795089292526245e-06 6.468027048110961e-06 5.1390735912323e-06 6.479820613861083e-06 5.141479425430297e-06 6.070827512741088e-06 6.443816785812378e-06 6.495168857574462e-06 6.262335305213927e-06 6.467509489059448e-06 4.6494723844528195e-06 6.470109729766845e-06 6.475036840438842e-06 6.477442245483398e-06 6.460979061126708e-06 6.459686880111694e-06 5.092949037551879e-06 6.2213045883178705e-06 6.4153845119476315e-06 4.120711998939514e-06 6.481844930648803e-06 6.4869831848144526e-06 4.491813640594482e-06 6.418076591491698e-06 5.586738567352295e-06 6.486529140472411e-06 6.426352815628051e-06 6.471943502426147e-06 3.098159160017967e-06 3.7826068925857542e-06 6.460158948898315e-06 4.991193537712097e-06 6.489760665893554e-06 6.249315004348754e-06 6.4975133228302e-06 6.012493114471435e-06 6.486269931793212e-06 6.394169311523437e-06 6.469550542831421e-06 6.464308862686156e-06 6.463121395111083e-06 6.473794870376587e-06 4.76784384727478e-06 6.47191174507141e-06 6.469574575424194e-06 6.484267072677612e-06 6.462109451293945e-06 6.4718542385101316e-06 6.449737815856933e-06 6.464719991683959e-06 6.462616281509399e-06 6.261651878356933e-06 6.475932483673095e-06 6.4674472618103026e-06 6.475038557052612e-06 6.24063323020935e-06 6.488953857421875e-06 6.246584515571593e-06 6.4792446899414055e-06 6.2451459932327265e-06 6.2385269451141354e-06 6.352545933723449e-06 6.477816038131714e-06 6.499710588455199e-06 5.622959976196289e-06 6.478142623901367e-06 6.473194913864135e-06 5.1325079727172845e-06 6.470846586227417e-06 6.462736444473266e-06 6.293011837005614e-06 3.6151314246654507e-06 3.7955299901962275e-06 6.486098699569702e-06 6.469578008651733e-06 6.479409914016723e-06 5.189179401397704e-06 6.481967668533325e-06 6.483974819183349e-06 6.47724268913269e-06 5.793265228271484e-06 6.47389100074768e-06 5.257776575088501e-06 6.485396604537963e-06 6.487084035873413e-06 6.435217409133911e-06 6.464425592422485e-06 6.410740642547607e-06 6.472928409576416e-06 6.486278085708618e-06 6.462865619659423e-06 6.46202748298645e-06 6.4240851688385e-06 6.222057752609252e-06 6.466894941329956e-06 6.469128684997558e-06 6.258030681610107e-06 4.608537154197692e-06 6.242346410751342e-06 6.47698691368103e-06 6.4726653385162345e-06 6.478856735229492e-06 6.48387954711914e-06 6.28657238960266e-06 6.263516550064086e-06 6.392988281249999e-06 6.4808827686309805e-06 6.450061826705932e-06 6.2479867744445795e-06 6.4669339942932125e-06 6.288991956710815e-06 6.341076807975769e-06 6.411247043609618e-06 6.0323197889328e-06 6.344087963104247e-06 6.46724341392517e-06 6.46077220916748e-06 5.953662614822387e-06 6.483488588333129e-06 6.212381629943847e-06 5.158745770454406e-06 6.359613876342773e-06 3.4330137240886685e-06 4.081953864097595e-06 6.48641541481018e-06 6.479137830734252e-06 6.450134782791137e-06 6.464311437606811e-06 6.274034671783447e-06 6.4808630275726314e-06 6.487481431961059e-06 6.484637432098388e-06 6.4539207744598384e-06 6.499113206863403e-06 5.012572889328003e-06 6.298296003341674e-06 6.476517419815063e-06 )
set i = 320
let index = 1
repeat $i
    let r_test = $r_array[$&index]
    alter @mn0[w] = $w_array[$&index]
    alter R0 = r_test
    op
    let gm = @mn0[gm]
    let ro = 1/@mn0[gds]
    let a0 = gm*r_test
    let id = @mn0[id]
    let pw = id*1.2
    let cgd = @mn0[cgd]
    let cdb = abs(@mn0[cdb])
    let cp = (1+a0)*cgd+cdb
    let bw = 1/(2*pi*r_test*cp)
    wrdata ../out/r-test.csv $r_array[$&index]
    wrdata ../out/w-test.csv $w_array[$&index]
    wrdata ../out/bw-test.csv bw
    wrdata ../out/pw-test.csv pw
    wrdata ../out/a0-test.csv a0
    set appendwrite
    let index = index + 1
end

.endc

.end

