nmos: cs amp

.include ../assets/45nm_CS.pm

.option TEMP=27C

V6 net2 0 dc 822.6m ac 1
Vdd net1 0 dc 1.2
R0 net1 out 500
mn0 out net2 0 0 NMOS W=5u L=45n

.control
set w_array = ( 1434.2356449365614 797.934085726738 1369.586269855499 900.4377907514571 1284.355415701866 905.758934020996 735.6496261060238 1436.7803782224653 676.7643281817436 1447.387836575508 1132.4373418092725 816.9715110957623 853.4244394302367 1042.827882170677 1439.4222247600553 1438.9916712045667 746.3693608343601 1133.9944189786909 869.0353080630301 866.8027174472808 1434.6252357959745 1267.320969700813 1309.4320559501646 1286.2547391653059 1438.7761718034742 880.9848141670226 673.4724894911051 1028.3010655641554 1439.5203274488447 676.9323717057705 860.6999683380126 767.7261133491993 1438.7756770849226 1140.4448562860487 1213.3393591642377 1434.7924011945722 1440.5153053998945 1248.0766159296033 1114.8303085565565 1351.4065009355543 831.4967074990271 1000.8908626437186 820.6519697606564 1452.3605000972746 924.0331941843032 1434.133337140083 1093.836085796356 1439.7105467319486 831.1882257461547 1268.5203653573988 1193.2553690671919 730.4820558428764 1310.495255589485 887.2854754328727 1419.4746285676954 1439.9948614835737 1437.8958696126936 1439.7207874059675 837.6032659411429 1245.4352146387098 1337.0124667882917 1405.2137726545332 1437.5577789545057 1010.0647997856139 1170.7564598321912 969.6833485364913 1142.6012355089185 1050.3194546699522 1224.1728049516676 825.9201781451702 964.606447815895 1145.3229790925977 1437.527601122856 973.8706463575362 1453.1154406070707 971.0256189107894 833.6902400851249 1439.4697672128675 822.7763406932354 1441.141816973686 1120.2166062593458 1443.4393888711927 1207.803508043289 1412.0686918497083 1442.3967695236204 1451.3839256763456 928.4176868200301 847.9355865716933 1178.008044362068 1222.1873015165327 1318.0014222860334 1049.7440969943998 1002.9807764291762 1439.5023691654203 774.5794741809368 1434.091879725456 1283.5777676105497 1262.5749367475507 1130.9958308935163 1438.239896893501 1435.814885497093 1368.066791296005 990.7964521646498 1172.4475562572477 1329.542513489723 954.0724551677703 1438.745548725128 1405.1770645380018 1001.6202014684676 1048.1857830286024 1387.1422976255415 842.8006306290625 1438.1704384088514 1236.3566344976423 748.2994557917118 1295.3937739133833 671.7430214583874 878.1768164038657 1453.5249686241148 1422.676150202751 1139.9179810285566 1437.9490023851392 677.7971706539392 974.474252462387 1438.4569793939588 963.1847751140593 698.0950090289116 1394.0799337625501 947.5893664360045 1362.1369463205335 1004.2811936140059 657.4538676440716 771.9878415763378 1447.1815389394758 1365.3111594915388 1439.0305560827253 1196.0555750131605 1011.7087990045546 1438.763704895973 1118.4500652551649 1437.6054698228834 1439.9561744928358 1327.9806375503538 1437.686702609062 766.1487527191639 1096.7361754178999 835.1324930787085 1074.392063617706 1438.5790759325025 959.297969341278 1148.3457589149473 1422.552767395973 817.4505965411663 1101.249591708183 1439.5372962951658 1438.9891976118085 951.8972766399382 1116.923660635948 791.0831861197948 1434.2317861318586 1140.7064634561536 889.8922216892241 1439.809539914131 963.7940210103988 1400.2686649560926 719.1855163872242 798.7081471085548 775.5305829644203 1440.096872448921 1031.6794490814207 917.2480303049086 1135.247145295143 1296.0746055841444 1438.587980866432 1170.1877313852308 1439.360434412956 1438.468852639198 1091.633697748184 912.2458320856093 1359.0096819400785 775.951724499464 1230.6787496805189 1452.7083861827848 778.216867595911 1333.2276719808576 1233.4633225202558 1453.2511913776395 1135.2116739749906 1040.661806464195 904.3600678443908 1015.326428413391 1349.807372689247 1449.4242960214613 1212.728777527809 1140.2627998590467 1051.684036850929 1439.298149347305 1195.0163692235944 1091.4994806051252 782.2105696797371 1433.9575141668317 1133.1269299983976 1214.061945080757 969.0306663513182 1301.7330974340437 1251.7400562763212 973.7450373172759 1441.1897552013395 1325.2658694982526 1433.8261169195173 1449.139338135719 720.5008122324944 1392.721634507179 1305.5916547775266 930.6291776895522 705.9641754627228 1134.7570770978925 713.8945323973894 968.3125081658362 872.0064145326613 1270.347806215286 1301.5585112571714 1088.3672195672987 863.0876284837722 1213.1023889780042 1439.4338506460188 1454.1113090515134 854.9224719405173 1184.2476326227186 985.7695674896239 1438.5749202966688 717.0262677967548 1450.395082235336 942.9920953512191 1168.0018669366834 699.8916412889957 1424.0589874982832 881.2617081403731 1033.2729870080946 1319.4798392057417 766.9113118946552 1438.2627528905866 1428.4869164228437 762.3178254067898 713.7777107954025 1375.8627146482465 1320.5916202068327 747.2157748043537 1439.9055647850034 1061.3499963283537 1434.2809611558912 1339.2263323068617 1124.1975075006483 649.1371540725231 1405.1226454973219 771.8498645722866 1449.2319494485853 1276.8756669759748 855.401755273342 717.6400156319141 1438.1408542394636 1372.9241359233854 852.2658827900885 1177.592480778694 1095.1191383600233 1189.9868130683897 768.4527064859867 1442.2368270158765 1436.0154938697813 1439.2782616615293 1230.2476519346235 735.3655587136745 1436.8937677145002 1230.9103769063947 917.3766076564788 709.8867679387331 1440.037308335304 1360.1602488756178 1383.6624968051908 740.1941725611687 939.0635848045348 1031.0875678062437 975.4399183392524 985.7688748836516 1006.3209676742553 1149.9716514348981 723.456570059061 1439.2183512449262 1439.5638626813886 1218.2862973213194 1230.4709184169767 708.6333057284355 1440.2957493066785 1201.9342166185377 1073.6215889453886 1406.7698603868482 1145.4893034696577 937.1412074565886 1330.9473162889478 1028.1822341680524 660.5318766087294 1330.8254176378248 822.5216595828533 895.8109107613562 792.1499229967594 1446.602421402931 1016.1271303892134 1109.9307644367216 1439.293301105499 979.1758102178572 1297.0131856203077 794.354759901762 1448.5724896192548 769.6943016350269 1439.2328464984892 1432.7695465087888 1443.2745486497877 1062.4903720617292 )
set r_array = ( 3.560843889713287e-06 6.3632073926925655e-06 6.458591465950012e-06 6.4018595266342155e-06 6.41628852367401e-06 6.402707533836364e-06 6.326725916862487e-06 5.110336189270019e-06 6.28192744731903e-06 6.343771033287048e-06 6.447443776130676e-06 6.375435690879821e-06 6.39358630657196e-06 6.4448298025131216e-06 4.974236826896667e-06 4.1801765727996825e-06 6.311288623809814e-06 6.422723679542541e-06 6.405534796714782e-06 6.401562552452086e-06 3.6156247365474697e-06 6.430285792350768e-06 6.443726878166198e-06 6.433845191001892e-06 5.275290112495422e-06 6.410415987968444e-06 6.261194186210632e-06 6.437779669761657e-06 4.802665572166443e-06 6.268219428062438e-06 6.400980620384216e-06 6.3462124872207635e-06 5.0927756595611564e-06 6.433591990470886e-06 6.420533280372619e-06 3.6510487782955166e-06 5.49302261352539e-06 6.411939053535461e-06 6.437521748542785e-06 6.440430979728698e-06 6.385493330955505e-06 6.414864163398742e-06 6.378301577568054e-06 5.958111433982849e-06 6.4110580015182486e-06 3.533319811820984e-06 6.4522996473312375e-06 4.484153251647949e-06 6.3821060228347775e-06 6.423159699440002e-06 6.444412665367126e-06 6.322397904396056e-06 6.433658938407897e-06 6.413895564079284e-06 6.4525313901901235e-06 4.622555236816406e-06 5.202118163108826e-06 4.82023425579071e-06 6.390209727287292e-06 6.423376421928405e-06 6.4457245874404905e-06 6.457566647529601e-06 6.387153296470642e-06 6.422570471763611e-06 6.407626490592956e-06 6.4204470205307e-06 6.418035607337951e-06 6.403691153526305e-06 6.439896254539489e-06 6.380255513191222e-06 6.406763892173766e-06 6.40693555355072e-06 4.994269280433655e-06 6.4114382314682004e-06 6.016983561515808e-06 6.423061852455138e-06 6.385622076988219e-06 4.373618559837341e-06 6.369609503746032e-06 5.590678625106811e-06 6.444268040657043e-06 5.637339835166931e-06 6.422441296577453e-06 6.457022051811218e-06 5.477026991844177e-06 5.898436360359191e-06 6.403817324638366e-06 6.391739230155944e-06 6.406450610160827e-06 6.409976534843444e-06 6.430817942619323e-06 6.431868081092834e-06 6.427757649421692e-06 4.622195391654968e-06 6.35482988834381e-06 3.532618199586868e-06 6.429672102928161e-06 6.439632325172424e-06 6.440377764701843e-06 4.117048959732055e-06 3.7631674754619596e-06 6.448640255928039e-06 6.406033473014831e-06 6.429852347373962e-06 6.4436002779006955e-06 6.4287592935562124e-06 4.8853917646408076e-06 6.456656413078308e-06 6.417248110771179e-06 6.4206354188919066e-06 6.4535356092453e-06 6.383661704063415e-06 5.069311265945434e-06 6.417854075431823e-06 6.331687788963317e-06 6.4191539812088005e-06 6.2780938196182246e-06 6.407503752708435e-06 6.188267712593078e-06 6.449945311546325e-06 6.447120623588561e-06 5.051661257743835e-06 6.279590277671813e-06 6.41834331035614e-06 5.268296627998352e-06 6.417521052360534e-06 6.2875169563293455e-06 6.464785866737365e-06 6.42069550037384e-06 6.443028216361999e-06 6.4223722028732294e-06 6.264544157981872e-06 6.352164845466613e-06 6.328910737037658e-06 6.458982424736023e-06 4.8590953874588006e-06 6.4245660352706906e-06 6.402928547859192e-06 4.598521571159362e-06 6.404782490730285e-06 4.89958429813385e-06 4.441165916919708e-06 6.434809498786926e-06 3.978668217658997e-06 6.323898010253906e-06 6.418182806968688e-06 6.387677721977234e-06 6.4382757711410515e-06 4.746624569892883e-06 6.421995406150817e-06 6.412086253166198e-06 6.447643332481384e-06 6.378824715614318e-06 6.437860779762268e-06 4.3213187026977535e-06 5.05208182811737e-06 6.416515974998473e-06 6.44084725856781e-06 6.36533341884613e-06 3.3376368927955626e-06 6.413905434608459e-06 6.411190180778503e-06 4.470703904628753e-06 6.408731989860534e-06 6.455860333442688e-06 6.30139127254486e-06 6.361626820564269e-06 6.340961580276488e-06 5.438452105522155e-06 6.411136107444763e-06 6.4216671037673945e-06 6.420315270423888e-06 6.427940468788146e-06 5.088878731727599e-06 6.4356866884231565e-06 4.291058020591736e-06 5.035708122253417e-06 6.4450220632553095e-06 6.413102488517761e-06 6.440720229148864e-06 6.3492809343338004e-06 6.4145337152481076e-06 6.2338639783859244e-06 6.327385954856872e-06 6.448953108787536e-06 6.4095585393905636e-06 6.0599465417861935e-06 6.406718401908874e-06 6.403531079292297e-06 6.399074749946593e-06 6.437250952720641e-06 6.433469252586364e-06 5.828951697349548e-06 6.4291961717605585e-06 6.406823115348815e-06 6.409331946372985e-06 4.4650462675094605e-06 6.432054333686828e-06 6.413724761009215e-06 6.360561232566833e-06 3.5228634345531463e-06 6.425273280143737e-06 6.41371832370758e-06 6.409048705101013e-06 6.421383004188537e-06 6.423680262565612e-06 6.413636355400085e-06 6.393635230064392e-06 6.446933512687683e-06 3.444178794622421e-06 5.9312550115585325e-06 6.295586113929748e-06 6.455574088096618e-06 6.428125863075256e-06 6.430699496269225e-06 6.271370487213134e-06 6.410106568336486e-06 6.302513079643249e-06 6.413301186561584e-06 6.404292826652526e-06 6.41902051448822e-06 6.442524390220641e-06 6.415904002189636e-06 6.402857737541198e-06 6.4169095087051385e-06 5.32860770702362e-06 6.096167521476745e-06 6.396133761405944e-06 6.4270392465591424e-06 6.4058412122726435e-06 5.134122877120971e-06 6.315095000267028e-06 5.961314635276794e-06 6.432976584434509e-06 6.406081538200378e-06 6.305408363342285e-06 6.4232245016098015e-06 6.39673285961151e-06 6.428682475090026e-06 6.422831826210022e-06 6.3503963041305536e-06 4.073031227588653e-06 6.439292006492614e-06 6.341736845970153e-06 6.295974068641662e-06 6.451079134941101e-06 6.423984532356261e-06 6.319690375328064e-06 4.606562190055847e-06 6.435044245719909e-06 3.5851356375217437e-06 6.435834746360778e-06 6.413818745613098e-06 6.251304774284362e-06 6.45977979183197e-06 6.354886107444762e-06 6.210665016174316e-06 6.429029231071471e-06 6.393052439689635e-06 6.284205822944641e-06 4.065537242889404e-06 6.456691603660583e-06 6.390926413536071e-06 6.418118863105773e-06 6.406066517829894e-06 6.41635504245758e-06 6.321832709312438e-06 5.456913857460022e-06 3.780950574874878e-06 4.294895939826965e-06 6.426935820579528e-06 6.317300419807434e-06 3.8913777637481686e-06 6.419244961738586e-06 6.425680117607116e-06 6.304385261535644e-06 3.102637791931629e-06 6.461593394279479e-06 6.451418595314025e-06 6.326695446968078e-06 6.4241008329391474e-06 6.420451741218567e-06 6.420869307518005e-06 6.419007639884948e-06 6.415034537315368e-06 6.415947775840759e-06 6.290592055320739e-06 4.6805645513534545e-06 5.263836436271667e-06 6.408483510017394e-06 6.4160035657882685e-06 6.297514085769653e-06 5.3686125326156615e-06 6.431905417442321e-06 6.411553244590759e-06 6.45970769405365e-06 6.427715163230896e-06 6.432688193321227e-06 6.427133660316466e-06 6.4410051870346065e-06 6.276611523628234e-06 6.438590340614318e-06 6.382253222465515e-06 6.416654162406921e-06 6.360541491508483e-06 5.666092686653137e-06 6.40486274242401e-06 6.441051106452941e-06 4.50951579093933e-06 6.413937621116638e-06 6.4313500928878775e-06 6.366862921714782e-06 6.1706810045242306e-06 6.349284796714782e-06 4.2540465402603145e-06 6.412433009147643e-06 6.327767043113708e-06 6.423292307853698e-06 )
set i = 318
let index = 1
repeat $i
    let r_test = $r_array[$&index]
    alter @mn0[w] = $w_array[$&index]
    alter R0 = r_test
    op
    let gm = @mn0[gm]
    let ro = 1/@mn0[gds]
    let a0 = gm*r_test
    let id = @mn0[id]
    let pw = id*1.2
    let cgd = @mn0[cgd]
    let cdb = abs(@mn0[cdb])
    let cp = (1+a0)*cgd+cdb
    let bw = 1/(2*pi*r_test*cp)
    wrdata ../out/r-test.csv $r_array[$&index]
    wrdata ../out/w-test.csv $w_array[$&index]
    wrdata ../out/bw-test.csv bw
    wrdata ../out/pw-test.csv pw
    wrdata ../out/a0-test.csv a0
    set appendwrite
    let index = index + 1
end

.endc

.end

