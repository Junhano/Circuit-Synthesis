nmos: cs amp

.include ../assets/45nm_CS.pm

.option TEMP=27C

V6 net2 0 dc 822.6m ac 1
Vdd net1 0 dc 1.2
R0 net1 out 500
mn0 out net2 0 0 NMOS W=5u L=45n

.control
set w_array = ( 1437.1694743633268 643.9483851194382 1285.557037591934 1309.2679083347318 1313.2558840513227 1101.0014903545377 1196.3755095005033 923.0187490582465 1430.8107578754423 1147.038514614105 884.9020946025847 1293.816759586334 1110.902935862541 1307.319310903549 809.258317053318 1068.1697410345075 835.3512576222419 1161.406031847 804.2463728785515 854.4311916828154 1436.6784167289732 1443.0349564552305 988.0337211489676 1428.5770046710966 919.81693059206 709.7339308261871 717.7031417191029 1442.7142798900602 833.9362388849257 1430.2085864543913 951.1708071827887 1422.784444093704 916.4683291316031 694.9307397007942 1217.1354335546491 1435.1590371131895 1348.6334550380705 1316.0150778293607 1119.4531565904615 1137.4588340520856 844.666857421398 1042.8550422191618 1285.4603695869444 860.0749656558036 1408.4675860404966 951.4463406801223 1053.4226757287977 1200.6140601634977 705.4725983738899 820.3735792636871 1435.5131566524503 1227.7640163898466 1435.6265461444852 1421.2118327617643 1319.150851368904 1228.8790130615232 1295.7683253288267 1386.0909217596052 1410.4763412475584 1435.3237783908842 878.2489463686942 759.4740594923496 1190.360721349716 1239.674068689346 725.1764096319675 886.369034051895 1437.12504863739 1149.6755623817442 881.0059139132499 1436.126112937927 700.9373031556606 1097.6061379909513 1352.6024335622785 903.9576637744902 1431.059898138046 1238.215687870979 676.7056669294834 1437.1312820911405 1117.2749602794645 1437.0781493186948 1146.5070384740827 1180.685906410217 1223.7200880050657 791.8734619021416 1435.6044816970823 1436.9482362270353 1442.8779327869413 1436.9994890689848 727.5801110267639 1033.654340803623 697.2832006216049 978.8484796881675 877.1499043703078 1291.0689938068388 1151.737846136093 876.0484135150908 651.0461956635118 847.5471583008765 1147.938605546951 680.315591096878 1437.162548303604 940.5872437357901 1341.0677736997602 1436.1988365650175 1365.4043149948118 1426.6458213329313 1354.6423065662382 1384.5119285583494 1428.932806253433 1435.960975885391 1240.98027408123 678.0342707037926 944.1247287392615 944.2383903264998 1335.277142524719 1351.5862816572187 910.5629727244376 1421.8907845020292 1437.3946702480314 1435.6934320926664 1155.4213720560072 1056.7492127418516 1202.1343302726743 1199.07078564167 836.0792112350463 1110.4385435581205 748.7866917252541 1120.5172467231748 1430.5311429500578 954.704161286354 740.4550747573376 711.0546809434891 1404.3606305122373 1033.9427122473714 1037.0815283060072 1436.5018022060392 1231.7322528362272 1424.7961676120756 840.8965083956717 788.2434892654419 775.2619755268097 1174.6142750978468 831.6041356325148 1381.9299924373624 964.4204583764075 1236.9558870792387 1432.319847345352 955.9897616505622 1435.1901054382322 897.2892287373542 811.3206008076668 1439.3790853023527 876.9583988189696 1230.845123529434 1110.0009155273435 1136.183251738548 1348.8086348772047 1016.0609617829322 1435.907447338104 704.5459905266762 881.3331702351569 1386.5314686298368 841.8808993697165 1212.8720974922178 829.7362267971039 997.0578822493552 1441.2972080707548 1263.145149350166 826.073676943779 847.3885515332221 1437.2139000892637 1114.3760085105894 1327.8807538747785 1355.627588033676 1441.6433131694791 933.7528058886527 1142.7678072452543 787.0646244287491 1439.8884475231168 1378.5142576694486 949.7854715585707 1019.0668717026709 700.1543121039867 1055.9078943729398 1439.6670114994047 1277.4065494537351 884.5125037431716 1299.0948128700254 1184.0977823734281 1273.4385108947752 948.3807924389838 1023.8931974768637 680.0175231695175 934.6781769394873 1270.8518749475477 1438.3395826816557 804.1254389286041 887.0262676477431 1433.7352371215818 999.469486773014 1139.9046730995176 1421.4900624752042 1436.3110387325285 1423.1602323055265 872.5368764996527 1257.5095629692075 1111.5875768661497 842.0121482014655 944.684107005596 1285.033823251724 923.9859238266944 1423.4548866748808 1352.43200302124 1437.3568737506864 737.4501419067383 1038.4204840660093 1435.7719933986662 798.8782684504986 1104.5616829395292 1435.4144108295438 1102.615410685539 1368.2036304473875 1206.3961327075956 1321.2248599529264 1311.062054634094 910.2763327956199 773.8329315185547 1431.8352210521696 679.3405997753143 1433.205690383911 1150.2303397655485 1433.7120842933653 1443.0393099784849 870.1415482163428 1241.0505735874174 1397.5826895236967 1247.687866091728 981.5571627020835 733.6770224571228 913.7578156590461 1024.5655694603918 962.7110573649405 1437.2112286090849 1132.7640044689176 857.5267940759658 955.1814410090445 1413.0393296480177 700.0826150178909 1229.9186146259306 1251.2206017971037 1436.4580690860746 1143.7081682682035 1057.830568552017 664.1694710031152 1124.138438105583 1156.53824865818 695.9557099640369 774.5529696345329 904.9734446406363 1428.5315895080564 975.1543667912482 1390.3239315748212 1436.5556275844572 1377.1936559677122 960.8817860484122 1044.61322247982 944.3796077370642 821.7597806453705 1062.5741773843763 1251.8747186660764 724.8995527625084 715.6432078778744 1342.8068578243253 807.464813888073 913.700923025608 1338.2043427228925 987.8384310007094 1436.745797395706 1158.8595670461652 1437.1242570877073 745.797181725502 774.9099461734295 1178.5564398765562 1387.333308458328 1437.3459899425504 1046.6521060466764 1189.660001993179 1354.308074712753 1443.643954992294 1421.8844521045683 1002.8350323438643 1443.1965315341947 928.4423485398291 1436.1494636535642 1435.6681025028226 663.611966483295 673.2769334316254 952.4904194474219 845.7868260145186 1244.0908169746397 1286.6539275646207 1442.3226606845853 1204.9937540292738 1210.93408703804 1170.3424298763273 1434.1722714900968 685.0574065744877 1254.2952775955198 1097.676486968994 1434.5506322383878 1292.9531788825986 800.0008095800877 1436.7163121700285 1276.256922483444 828.0000367760658 1413.2804059982298 1246.1788755655286 1438.040871620178 1230.7654243707655 1073.4709966182706 )
set r_array = ( 4.4905452775955195e-06 6.314350848197937e-06 6.448843460083007e-06 6.468690304756164e-06 6.469107012748718e-06 6.451185135841369e-06 6.4560751247406e-06 6.468840937614441e-06 6.425289158821105e-06 6.464742951393127e-06 6.462176613807678e-06 6.462212233543396e-06 6.453413944244384e-06 6.467186551094054e-06 6.393502621650695e-06 6.452312521934509e-06 6.43865557193756e-06 6.463775210380554e-06 6.3929805564880365e-06 6.448573522567748e-06 5.586146550178528e-06 6.229951601028441e-06 6.480497388839721e-06 3.7453895795345305e-06 6.472025685310363e-06 6.335334520339965e-06 6.2957032728195185e-06 6.024973111152648e-06 6.4404665994644155e-06 3.838072507381439e-06 6.473549823760985e-06 6.453927640914916e-06 6.473158435821532e-06 6.286213402748107e-06 6.453789238929748e-06 5.219624619483948e-06 6.46739833831787e-06 6.462770562171936e-06 6.448953537940978e-06 6.44752016544342e-06 6.443675165176391e-06 6.4746821451187125e-06 6.467492966651916e-06 6.451668362617492e-06 6.465134553909301e-06 6.4676775026321405e-06 6.459833436012268e-06 6.453153662681579e-06 6.277910141944885e-06 6.424059205055236e-06 5.390360527038574e-06 6.465827207565307e-06 5.085178570747375e-06 3.283023979067802e-06 6.470417647361755e-06 6.4637185621261595e-06 6.469901375770568e-06 6.483163290023803e-06 6.476209502220153e-06 5.169926934242248e-06 6.4579462337493895e-06 6.3236928749084465e-06 6.45129156589508e-06 6.449702410697937e-06 6.348318343162536e-06 6.462331752777099e-06 4.770550732612609e-06 6.4599645423889155e-06 6.460362582206725e-06 4.298791794776916e-06 6.324976472854614e-06 6.46845727443695e-06 6.469514279365539e-06 6.465349345207213e-06 6.373604063987731e-06 6.430726103782653e-06 6.314264588356018e-06 4.471367590427398e-06 6.466561703681945e-06 4.779003338813781e-06 6.459298281669616e-06 6.460652260780334e-06 6.465227680206298e-06 6.380787663459777e-06 5.095191149711608e-06 4.81561098575592e-06 6.226643900871276e-06 4.804841594696044e-06 6.301776223182677e-06 6.467581586837768e-06 6.293334774971008e-06 6.477606396675109e-06 6.4562148141860955e-06 6.46000681400299e-06 6.456924419403076e-06 6.458100514411926e-06 6.298502640724181e-06 6.443247942924499e-06 6.450630669593811e-06 6.31954575061798e-06 5.560060029029845e-06 6.473839716911315e-06 6.458349208831787e-06 5.833791689872741e-06 6.474146347045898e-06 3.6377895462512966e-06 6.471114592552184e-06 6.479202847480773e-06 3.7667477953433987e-06 5.012364106178283e-06 6.463406567573547e-06 6.271948556900024e-06 6.471893506050109e-06 6.470377306938171e-06 6.469854598045349e-06 6.470354132652282e-06 6.468430452346801e-06 3.3505957174301146e-06 4.63830066204071e-06 4.248539750576019e-06 6.461677293777465e-06 6.473032264709472e-06 6.456192498207092e-06 6.461444907188415e-06 6.4244117546081535e-06 6.466955881118774e-06 6.358048110008239e-06 6.457921986579894e-06 3.858617584705352e-06 6.464683728218078e-06 6.336327581405639e-06 6.319438891410827e-06 6.480784492492675e-06 6.458116822242736e-06 6.461901097297668e-06 4.350822894573211e-06 6.459771637916564e-06 3.535474108457565e-06 6.442275481224059e-06 6.367797617912292e-06 6.3668822336196895e-06 6.46009693622589e-06 6.419609313011169e-06 6.480260925292968e-06 6.474453835487365e-06 6.460159163475036e-06 6.412108998298644e-06 6.468419723510742e-06 5.3882883596420285e-06 6.4663627910614e-06 6.399036984443664e-06 5.744082741737365e-06 6.459355788230896e-06 6.460499696731567e-06 6.465964751243591e-06 6.45473337650299e-06 6.47071934223175e-06 6.47657278060913e-06 5.401974921226501e-06 6.271406106948852e-06 6.4581215429306025e-06 6.48204062461853e-06 6.444693760871886e-06 6.458969979286193e-06 6.418918805122375e-06 6.4739954996109006e-06 5.8457837390899655e-06 6.46792598247528e-06 6.428858857154846e-06 6.44746265888214e-06 4.4945027160644525e-06 6.449138503074645e-06 6.465529589653015e-06 6.471508555412292e-06 6.2698154497146605e-06 6.479047923088073e-06 6.4639970827102656e-06 6.381364874839782e-06 6.3094190168380735e-06 6.477338819503784e-06 6.471948866844177e-06 6.458480744361877e-06 6.273200182914733e-06 6.457123761177063e-06 5.732683568000793e-06 6.44354169845581e-06 6.460924987792968e-06 6.470350699424743e-06 6.455551128387451e-06 6.468284754753112e-06 6.465860896110534e-06 6.474519281387328e-06 6.27844057559967e-06 6.468651251792907e-06 6.462250642776489e-06 6.288461308479309e-06 6.398149065971374e-06 6.462493758201599e-06 4.07293520450592e-06 6.461034636497497e-06 6.44891233921051e-06 3.3125739562511442e-06 4.899653391838073e-06 3.4375810968875884e-06 6.457904605865478e-06 6.465817980766296e-06 6.4672916936874385e-06 6.430479340553283e-06 6.469565563201903e-06 6.442993669509887e-06 6.468184762001037e-06 6.452730088233947e-06 6.470864181518554e-06 4.623604516983032e-06 6.337268285751342e-06 6.471634726524352e-06 5.0533220815658565e-06 6.414344887733459e-06 6.463267951011657e-06 5.304672102928161e-06 6.448608927726745e-06 6.475752453804016e-06 6.4383309173583975e-06 6.4697367954254145e-06 6.467868905067443e-06 6.469105725288391e-06 6.357677106857299e-06 3.939012830257415e-06 6.305236916542053e-06 4.034028797149658e-06 6.449343638420104e-06 4.071154968738555e-06 6.042060499191284e-06 6.457227187156677e-06 6.465853171348571e-06 6.483726768493652e-06 6.465720562934875e-06 6.48086817741394e-06 6.349352602958679e-06 6.474494605064392e-06 6.470013599395751e-06 6.466229109764099e-06 4.735393624305725e-06 6.457895593643188e-06 6.4514488506317135e-06 6.471057515144348e-06 6.446423892974853e-06 6.2899916696548455e-06 6.465839009284973e-06 6.458365731239318e-06 4.364713625907898e-06 6.453409867286682e-06 6.452797465324402e-06 6.309337906837463e-06 6.466202931404113e-06 6.4587616252899164e-06 6.3218511629104605e-06 6.376812200546264e-06 6.467426877021789e-06 6.433889822959899e-06 6.480103855133056e-06 6.4837718296051016e-06 4.361149613857269e-06 6.4793691444396965e-06 6.469088559150695e-06 6.457574801445007e-06 6.475675420761108e-06 6.40830991744995e-06 6.457477812767028e-06 6.465408997535705e-06 6.336714248657226e-06 6.314112238883972e-06 6.467721061706542e-06 6.416579918861388e-06 6.470569567680359e-06 6.459738163948058e-06 6.4759387063980095e-06 4.855672674179077e-06 6.464814190864563e-06 4.656218461990356e-06 6.3508924055099485e-06 6.394161372184753e-06 6.454827146530151e-06 6.4802497673034665e-06 4.560502867698669e-06 6.469273309707641e-06 6.456335406303405e-06 6.4707234191894526e-06 6.180760102272033e-06 3.3482781279087064e-06 6.477666907310485e-06 6.231635384559631e-06 6.469193272590637e-06 4.317734842300415e-06 5.063205056190491e-06 6.2825218248367304e-06 6.293650202751159e-06 6.4744094181060785e-06 6.437728600502013e-06 6.459302358627319e-06 6.4692803907394406e-06 6.003555779457091e-06 6.46018341064453e-06 6.455229048728942e-06 6.456806616783141e-06 5.3848933267593375e-06 6.320995001792907e-06 6.427889399528503e-06 6.4624946165084835e-06 4.1392954158782956e-06 6.448393278121948e-06 6.399268512725829e-06 5.500365643501282e-06 6.468818192481994e-06 6.420661168098449e-06 6.4740349817275995e-06 6.465063529014587e-06 5.72617760181427e-06 6.443412308692932e-06 6.4652124452590935e-06 )
set i = 320
let index = 1
repeat $i
    let r_test = $r_array[$&index]
    alter @mn0[w] = $w_array[$&index]
    alter R0 = r_test
    op
    let gm = @mn0[gm]
    let ro = 1/@mn0[gds]
    let a0 = gm*r_test
    let id = @mn0[id]
    let pw = id*1.2
    let cgd = @mn0[cgd]
    let cdb = abs(@mn0[cdb])
    let cp = (1+a0)*cgd+cdb
    let bw = 1/(2*pi*r_test*cp)
    wrdata ../out/r-test.csv $r_array[$&index]
    wrdata ../out/w-test.csv $w_array[$&index]
    wrdata ../out/bw-test.csv bw
    wrdata ../out/pw-test.csv pw
    wrdata ../out/a0-test.csv a0
    set appendwrite
    let index = index + 1
end

.endc

.end

