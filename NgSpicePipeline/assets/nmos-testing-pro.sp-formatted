nmos: cs amp

.include ../assets/45nm_CS.pm

.option TEMP=27C

V6 net2 0 dc 822.6m ac 1
Vdd net1 0 dc 1.2
R0 net1 out 500
mn0 out net2 0 0 NMOS W=5u L=45n

.control
set w_array = ( 1040.9742707014082 1443.4976172447202 1442.7156156301496 1444.3004465103147 756.9689036905766 1134.1651463508604 1442.2645807266233 1443.5226994752882 1444.7440606355665 1429.5293873548505 753.7638448178768 887.332473695278 724.2793488502502 869.662091732025 1443.3581560850141 1368.5450851917265 1244.115404486656 746.7446048557758 1086.5294885635374 899.462700486183 1432.4818181991575 1217.0403486490247 1447.8268992900846 929.121300280094 1154.5633816719053 1442.4912607669828 884.4732972979544 1005.4216435551642 1448.6678713560102 1446.653525829315 1345.7251036167143 794.5020747184753 1225.6928771734235 1164.8369050025938 1447.9703181982038 1447.7591723203657 1447.9770958423612 772.4132624268532 1431.5835577249525 911.5125355124472 1376.6621303558347 1254.553916454315 788.3840388059616 981.3322141766547 943.7118861079215 1116.8977868556974 1448.3430391550062 1445.4634803533552 1442.0680785179136 1406.8073600530622 784.9200813472271 1444.9040031433103 773.9035278558731 1448.772158026695 672.3355334997177 1448.2721459865568 1381.7634701728819 679.3851120769978 1448.3303248882291 1340.6385064125059 1022.5773203372954 1444.6960729360578 800.8355358242989 1446.0158336162565 889.1118031740187 1282.7846843004224 1446.0159325599668 742.6773628592491 1420.2752315998075 1251.1810243129728 1081.7539209127424 1405.5000662803648 1388.3445131778715 1011.3186886906623 1443.7525951862333 1237.2364914417265 782.9412071406841 1445.363003015518 1448.104931116104 1157.9729819297788 1441.7540311813352 1311.93186879158 1448.2822382450101 1448.904643654823 1195.9882438182829 1442.699092030525 937.4598309397696 1363.2656466960905 1312.489911317825 1035.2717489004133 1263.8793116807935 1441.7184114456174 1154.7936236858366 1447.568408846855 1267.3671269416807 1448.0378967523573 821.9297659397125 1049.4463258981702 1090.644705891609 1279.1490471363065 1443.731025457382 1347.700613737106 1193.929225206375 1363.789355754852 1392.191741466522 1442.403596639633 1410.0407910346983 766.4599059522152 654.9834441766143 1278.3355319499967 1122.9970729351041 1045.137376785278 1366.0018360614774 1448.192397356033 1443.5687083005903 1441.7597699165342 1000.4645636677741 1372.7441573143003 969.984656870365 943.3006018400191 1090.869110226631 821.4964666962624 906.6253840923308 1447.9036796092985 1352.6132678985593 1182.5220543146131 1448.0977576971052 809.3897885084152 898.5358947515487 1063.8382327556608 1448.47577214241 1056.0675400495527 926.7832109332084 730.0653420388699 835.6996878981589 1111.336952447891 984.2999812960624 1085.3602707386015 1306.4357435703275 1030.2038520574567 732.5611847639084 707.7600841969252 1095.5669081211088 1117.202830314636 1235.7898354530332 1441.9332677125929 1447.2796416282652 923.2842150330542 1414.2853277921674 1308.7572598457334 1192.99015045166 766.9963416457176 1171.7185884714124 682.6993429660797 800.0174568593502 1255.455194711685 1401.714776754379 889.6533221006392 863.9908361434935 788.7109611928463 1448.4217983484266 1384.070837497711 1049.5779705047605 776.9700284302235 1176.910164952278 1445.5128532648084 751.8502363562584 815.0848153233528 954.787496626377 1460.1345074176786 1442.6393300294874 1063.626592159271 1208.000702857971 1422.060967683792 848.3593872189521 1207.9422765970228 845.1539078354834 1185.8610582351682 709.0583184361458 1330.0005733966825 902.759777009487 1448.3888995647428 1327.0730268955228 649.8635709658265 858.6346915364264 1437.4862921237943 887.6153537631034 964.7843980789183 888.5667964816092 829.0318465232849 877.638265788555 1441.8241822719572 1147.7091550827024 1443.4478980302808 1086.5815329551695 1411.7592453956602 1122.865180969238 1448.480620384216 1357.0458966493604 1098.1545829772947 851.4644882082938 674.409257620573 1203.9838355779646 778.1255301833153 1180.1914352178571 1441.6751730442045 1010.2185830473899 1267.9822599887846 967.2111162543296 1207.5653505325315 1447.459818124771 1254.6869462728498 1270.0835770368574 775.6145861744881 919.8672434687613 1071.8184387683866 726.9529192149639 1448.4263497591016 1417.2523033618925 1369.3336170911787 965.3753641247748 1448.3005428314207 1442.4739456176756 1039.8118305206297 1049.0889906883237 774.5599946379662 1441.838034391403 1418.9439439773557 1443.3887296915052 837.1052327752112 864.5993152260779 1296.8910396099088 697.6420199871063 1189.3399190902708 755.9651073813438 1203.824288845062 1448.5637331008909 1211.2212216854093 825.0980795919895 1006.0729405283927 1243.4489691257475 1446.3654512166975 705.7630785554647 1447.5964099168775 1444.9384355545042 1447.9082310199735 701.8638367950916 1446.1176961660383 1446.4326834678648 994.2561921477317 1434.4081532955167 845.4722839593886 877.875978052616 1175.4540598392484 1445.5566358566282 1315.6399822235105 1130.0644242763517 747.5664313137531 674.6800108999014 892.9620987176894 1039.5250916481016 816.760723888874 1244.0090894699094 1445.0734937191007 1040.529320836067 1444.5353388786314 1448.7218946218488 1443.7628853321073 939.3867844343184 841.2762543559073 1237.5122475624082 1238.8252800703046 1294.4893294572828 1300.9789979457853 1043.943917751312 1447.7281534671781 1444.6155327558515 1443.1954431533811 1448.2635378837583 1222.9052865505216 693.2107888162136 646.6533824801445 980.2859833836554 1170.4954957962034 963.4849703311919 950.3993678092955 1406.274993419647 1350.1517462730405 1127.643766403198 1445.7312220335004 734.1087386012077 713.1252264976501 1447.8439176082609 1442.833111286163 864.5828410983084 1322.832200527191 980.3420844674109 1054.8872405290601 1063.4625929594038 861.2159350514411 1339.5559632778165 871.2248334288596 1037.8945487737653 994.5545569062232 932.3159453272818 690.1757647097111 1444.1318464279173 1105.909889936447 1441.761847734451 1288.458957672119 765.6480480730534 1442.355213165283 901.760964989662 1304.85472202301 1322.4616563320158 1300.5899018049238 1442.0101964473722 647.9840053245425 )
set r_array = ( 6.476419143676757e-06 5.217138319015503e-06 5.666985540390014e-06 5.808691577911376e-06 6.303337697982788e-06 6.464638881683349e-06 5.595399956703186e-06 5.7479043531417845e-06 6.2809006977081295e-06 6.482376651763915e-06 6.2956296730041495e-06 6.446130781173706e-06 6.2368365097045895e-06 6.432781748771667e-06 5.7327964353561395e-06 6.469270520210266e-06 6.485277729034423e-06 6.289436559677124e-06 6.468612842559814e-06 6.4561907815933225e-06 6.45375898361206e-06 6.478536586761474e-06 4.7055985736846916e-06 6.4717113304138176e-06 6.466017107963562e-06 5.653930692672729e-06 6.441147665977477e-06 6.474789862632751e-06 4.4082572507858275e-06 4.888629298210143e-06 6.473657112121581e-06 6.3333181428909295e-06 6.478731422424315e-06 6.461309294700622e-06 4.554082517623901e-06 4.627600793838501e-06 3.6553447651863096e-06 6.3299188184738154e-06 6.480381517410278e-06 6.4649268436431875e-06 6.481324796676635e-06 6.485912876129149e-06 6.325281171798705e-06 6.472290258407592e-06 6.4746031808853145e-06 6.464329676628112e-06 4.461218862533569e-06 4.976926975250244e-06 5.5300283002853385e-06 6.497018508911133e-06 6.3274226474761954e-06 5.892277150154113e-06 6.3298877048492425e-06 4.19451609134674e-06 6.162191061973571e-06 6.246712832450866e-06 6.473594884872436e-06 6.220753555297851e-06 6.177333097457885e-06 6.476079897880553e-06 6.479361848831176e-06 6.09449875831604e-06 6.358723812103271e-06 4.994620327949523e-06 6.440307812690734e-06 6.493190460205077e-06 6.290519528388977e-06 6.271188526153564e-06 6.488937120437621e-06 6.4886028099060054e-06 6.4693707275390616e-06 6.497593145370483e-06 6.4791303205490106e-06 6.479066162109374e-06 5.181082992553711e-06 6.48182089805603e-06 6.329410915374755e-06 5.009048466682433e-06 3.874450664520263e-06 6.4637468862533565e-06 5.378831748962402e-06 6.48334825515747e-06 4.500676946640015e-06 4.223598747253417e-06 6.478394966125487e-06 5.666000633239746e-06 6.461006956100463e-06 6.468737082481383e-06 6.485908155441284e-06 6.479410772323608e-06 6.49114683151245e-06 6.342314915657043e-06 6.473712043762206e-06 4.692525701522826e-06 6.491422777175903e-06 6.114193468093872e-06 6.38367693901062e-06 6.474911527633667e-06 6.468937926292419e-06 6.4930479812622065e-06 5.1312612819671625e-06 6.475096278190612e-06 6.473148994445801e-06 6.483637933731079e-06 6.482592945098876e-06 5.625735311508178e-06 6.497215919494628e-06 6.310611419677734e-06 6.1960102844238274e-06 6.4929110813140866e-06 6.470939283370971e-06 6.477317361831665e-06 6.468407063484192e-06 3.83861474275589e-06 5.840686683654784e-06 5.415473299026489e-06 6.476825981140136e-06 6.474933629035949e-06 6.47593505859375e-06 6.4721580791473385e-06 6.4689535903930654e-06 6.375359516143798e-06 6.460942153930663e-06 4.733621864318847e-06 6.471321659088134e-06 6.4712137269973745e-06 3.7517743098735808e-06 6.35599868774414e-06 6.454509787559508e-06 6.472366218566894e-06 4.4870654869079585e-06 6.473714833259582e-06 6.46738031387329e-06 6.271323924064636e-06 6.3946555423736566e-06 6.465393762588501e-06 6.482452611923217e-06 6.470023255348205e-06 6.489060287475585e-06 6.476625137329101e-06 6.211554007530212e-06 6.230951528549194e-06 6.4676137733459465e-06 6.46869330883026e-06 6.486555747985839e-06 5.3921779918670645e-06 6.158230190277099e-06 6.469929270744323e-06 6.4944641876220695e-06 6.4898113059997555e-06 6.466203789710998e-06 6.294888310432434e-06 6.466905241012573e-06 6.174824481010436e-06 6.346330504417419e-06 6.488444881439209e-06 6.488145761489867e-06 6.4544947671890255e-06 6.4274900722503654e-06 6.323477869033813e-06 4.383855800628662e-06 6.482951288223266e-06 6.475283603668212e-06 6.305613927841186e-06 6.465245060920715e-06 5.032427673339843e-06 6.296393995285033e-06 6.3642504501342766e-06 6.471207718849181e-06 2.989226283431053e-06 6.366839532852172e-06 6.472498826980591e-06 6.479359703063964e-06 6.493903713226318e-06 6.410634212493896e-06 6.477346329689025e-06 6.405612044334411e-06 6.473250703811645e-06 6.250725631713866e-06 6.479269580841064e-06 6.463191561698913e-06 4.422273187637329e-06 6.480862598419189e-06 6.193973951339721e-06 6.42189863204956e-06 6.370477681159972e-06 6.4478815126419065e-06 6.474955945014953e-06 6.4487930345535275e-06 6.386748175621032e-06 6.442592840194702e-06 5.4465616035461425e-06 6.465316514968871e-06 5.7922992038726804e-06 6.469608907699584e-06 6.496342163085937e-06 6.463953738212585e-06 4.012143473625183e-06 6.4781323242187494e-06 6.467453055381775e-06 6.413619403839111e-06 6.216760067939758e-06 6.46914885520935e-06 6.313672356605529e-06 6.462945656776428e-06 6.418945627212524e-06 6.475002508163451e-06 6.492064790725708e-06 6.480772047042846e-06 6.471845870018005e-06 4.702645354270935e-06 6.486346321105956e-06 6.492210702896117e-06 6.33012309551239e-06 6.4571123886108395e-06 6.472642164230346e-06 6.19981987953186e-06 3.976170115470886e-06 6.49374020576477e-06 6.477990703582763e-06 6.478723912239074e-06 3.829222183227539e-06 5.289918022155761e-06 6.478081469535827e-06 6.47430706501007e-06 6.324553327560424e-06 5.555316381454467e-06 6.494365911483764e-06 5.735174589157104e-06 6.3959415006637564e-06 6.427948408126831e-06 6.481074171066284e-06 6.217828874588012e-06 6.467294054031371e-06 6.295317678451538e-06 6.480299549102783e-06 4.4951996612548825e-06 6.479321293830871e-06 6.379603199958801e-06 6.482773618698119e-06 6.482702379226684e-06 4.86165807723999e-06 6.178115444183349e-06 4.768894414901733e-06 6.313870410919189e-06 6.186675767898559e-06 6.178905944824218e-06 6.059836893081665e-06 4.8601455259323115e-06 6.4832843112945555e-06 6.468526797294616e-06 6.407283811569213e-06 6.440181427001953e-06 6.469574790000915e-06 5.978951768875122e-06 6.4860291767120356e-06 6.4632042217254636e-06 6.30060956954956e-06 6.155432753562926e-06 6.451390271186828e-06 6.478109149932861e-06 6.378215532302856e-06 6.4872007656097405e-06 5.045564918518066e-06 6.477538375854491e-06 5.8275833415985104e-06 4.057096438407898e-06 5.1227696228027336e-06 6.476053075790404e-06 6.404106788635253e-06 6.4809308338165275e-06 6.4840022850036615e-06 6.490077381134033e-06 6.481830768585204e-06 6.477948217391967e-06 4.653624444007873e-06 5.837052397727966e-06 5.271992497444153e-06 4.0316407728195185e-06 6.483550815582275e-06 6.1727574634552e-06 6.172547392845153e-06 6.482722549438476e-06 6.4647264289855955e-06 6.481156139373779e-06 6.479061441421508e-06 6.496575622558593e-06 6.472123532295226e-06 6.467324523925781e-06 4.936177353858947e-06 6.236422805786132e-06 6.260707740783691e-06 6.312131695747375e-06 5.3061541843414305e-06 6.424870090484619e-06 6.4812913227081295e-06 6.47621078968048e-06 6.474185829162597e-06 6.474337964057922e-06 6.421130447387695e-06 6.475388746261596e-06 6.432869081497192e-06 6.477940707206726e-06 6.482995491027831e-06 6.469595174789428e-06 6.223538975715636e-06 5.87453272819519e-06 6.467512922286987e-06 5.529145531654358e-06 6.492803363800048e-06 6.285251669883728e-06 6.399600462913512e-06 6.450874428749084e-06 6.485572128295898e-06 6.483616046905517e-06 6.491629199981689e-06 5.407417016029357e-06 6.162483530044555e-06 )
set i = 318
let index = 1
repeat $i
    let r_test = $r_array[$&index]
    alter @mn0[w] = $w_array[$&index]
    alter R0 = r_test
    op
    let gm = @mn0[gm]
    let ro = 1/@mn0[gds]
    let a0 = gm*r_test
    let id = @mn0[id]
    let pw = id*1.2
    let cgd = @mn0[cgd]
    let cdb = abs(@mn0[cdb])
    let cp = (1+a0)*cgd+cdb
    let bw = 1/(2*pi*r_test*cp)
    wrdata ../out/r-test.csv $r_array[$&index]
    wrdata ../out/w-test.csv $w_array[$&index]
    wrdata ../out/bw-test.csv bw
    wrdata ../out/pw-test.csv pw
    wrdata ../out/a0-test.csv a0
    set appendwrite
    let index = index + 1
end

.endc

.end

