nmos: cs amp

.include ../assets/45nm_CS.pm

.option TEMP=27C

V6 net2 0 dc 822.6m ac 1
Vdd net1 0 dc 1.2
R0 net1 out 500
mn0 out net2 0 0 NMOS W=5u L=45n

.control
set w_array = ( 881.2668779492377 859.6036720275878 1437.7697658538816 1270.396486520767 1089.2708230018613 1442.2474634647367 851.6161441802977 728.9624659717083 710.1987374573946 757.8423169255257 841.4060932397841 851.8872499465941 1210.1195824146268 1122.275377511978 950.1912149786948 1137.739289999008 1086.8150895833967 744.6252182126045 1011.765147447586 807.3531559109688 1386.5543246269224 687.9773158580065 1439.3768095970152 1437.6659739017484 781.6528487205505 1441.6213476657865 1441.4973711967466 989.2725953459739 775.4013748466969 779.2394879460335 1146.0485827922819 874.668569266796 1438.686281442642 1439.4947504997251 987.2428640723227 1148.0004453659055 990.3041329979895 1018.7044903635978 877.0709225535392 1093.049730658531 1382.5416624546049 802.3864413797855 1438.8515174388883 792.8470680117607 714.6098521351814 1318.0752837657926 677.5587410479784 902.0987588167189 1021.0786446928977 1150.3126609325407 743.8156978785992 784.7699961066246 1402.867965698242 929.7166445851325 1243.4468913078306 1440.343984365463 708.4561655670404 1266.561527252197 951.430386006832 1445.6348013877866 1440.2453374862669 996.2693256139754 1414.7611975669859 1437.1011042594907 1078.6745452880857 1170.6104683876035 1232.842797040939 635.80282561481 1131.5468978881834 743.2736471295357 1165.7874572277067 888.0944392085074 992.1904948353766 722.2176958620548 1136.4202713966367 1039.3237411975858 1439.8142397403715 1442.6432383060453 977.5494724512099 975.7647505402564 1439.203757047653 1416.5761220455167 629.9669215083122 1439.117577075958 1440.7657814025877 1216.6441285610197 728.3833731710911 1190.1800501346586 878.4520530700682 767.4885123968124 1141.2923586368559 883.5946771502494 663.5366053879261 993.2330647110938 1446.0760903358457 1440.500909090042 1444.8677897453306 1139.6336662769315 1437.698823213577 922.6308897137641 890.2050817012786 718.5093474388123 933.397845327854 1440.2442491054533 721.490243151784 1436.8926298618314 1439.0801763534544 1110.4736685752866 1348.7254726886747 1074.5764946937559 647.4002281576395 889.0599319338797 1223.4160339832304 1068.0876672267912 1443.0939269065855 1440.9170663356779 1267.8796553611753 1383.5581111907957 1439.2892444133756 977.9613503813742 1440.3238987922666 929.3843916058539 1440.6422996520994 1298.7224876880643 1190.8592987060545 656.1869398131967 1215.2810800075529 1438.1229948997495 1438.4426820278165 909.0832200646399 1443.6007165908811 1443.789699077606 714.8053030669689 665.639691054821 933.6092138290404 1337.1308529376981 1148.6927545070646 1146.2041223049162 1090.7468652725217 1328.9886760711668 1276.5093278884885 1397.733083963394 913.0816343426703 1447.463182210922 1438.9791548252103 1050.8001726865766 958.9156013727187 1439.4649684429166 1033.1831461191175 753.5470344126225 1015.9637990593909 1197.0269548892973 840.2087259292601 1121.0235416889188 1437.948656082153 1124.3907940387724 1305.0356900691984 1012.5666657090186 1446.4096295833585 1201.5564000606535 865.8087289333342 669.9050276353955 1072.5297451019285 667.6157515496016 1313.7388777732847 1437.049158811569 1439.503160715103 1208.0963814258573 1081.5154170989988 1052.077832818031 990.5404600501059 1442.1433746814726 1323.1713795661924 822.6847435534 715.3822562098503 731.9477584958076 1040.074130296707 1092.6851725578306 1443.601903915405 1242.9716646671293 1325.631911754608 1438.9987456798551 876.7379522323607 1352.5783407688139 1344.562712907791 1250.307054519653 1437.4921298027036 1373.8469839096067 1085.646218061447 1445.2044951915739 728.228118121624 930.1848709583281 752.04958319664 1436.9863295555112 1057.3105204105375 1050.0782299041746 897.8288182616233 1363.999215364456 1439.5195853710172 1243.1181013584135 1331.7079460620878 1190.8394110202787 720.756464228034 1444.2351436614988 1357.013393640518 1447.411731481552 831.2724268436431 1435.6820535659788 1445.1457226276395 1300.2755081653593 1436.5131807327268 1326.538631916046 679.8241624236107 1007.6685562729834 1303.1209313869474 1227.228829860687 1365.4535889625547 846.9780588150023 1024.5537951588628 851.0850390791892 1024.4012734293935 750.5805411934853 867.8052893280982 820.621767193079 1440.0918757915495 876.8117147684096 1360.8122384548185 962.7643385529517 1184.7098481655119 1335.6858789920805 772.8362467885017 1221.7056930065153 1299.2506492137907 1440.0240993499754 1192.1867275238035 695.3064166009426 1223.4907364845274 1442.6346302032468 1161.0775387287138 1307.633556127548 1398.7950468063352 1030.7649865746496 1151.1789131164549 911.6208788752555 1052.5890254974363 1374.7476685047147 770.7368467748165 776.1097376048565 1111.321220397949 1440.8379113674162 1444.242762327194 1132.069419622421 1326.7185115814207 1438.9313650131223 1074.9265575408933 703.0062656104565 788.2439345121384 922.6828598976134 1446.8523037433622 805.0926260650158 1069.376310110092 793.1639723479748 794.0635314583778 646.8212528526783 1439.116686582565 1446.2444925308225 764.3259993195534 777.9029315710068 1322.5234961509702 1288.05398106575 694.6631959080696 969.9549737572669 1295.514336824417 863.2860600948333 874.7348862886428 639.1186241433024 1191.3402640819547 998.3596104383467 1196.4009380340574 975.3074327111243 1444.4489610195158 951.3518741726874 1442.6992404460905 741.650760024786 1439.6272361278532 834.3186563253402 921.3406637310981 893.5073032975196 931.7956992983817 1153.7459087371824 749.5457755029202 1442.3941969871519 739.645504951477 925.0797960162162 665.8804272860289 1279.4049155712125 1439.6539509296415 941.66088193655 1440.1079046726225 1073.010512590408 1438.5966384410856 1441.8356597423551 1441.160863637924 751.5999829769135 1297.8157675266264 1326.9026458263395 1440.1014733314512 1439.628423452377 1403.207639455795 1213.560547828674 1362.4178969860075 799.850204885006 701.5051411092281 1342.2812688350675 682.475693076849 1441.310565471649 1140.5684864521024 982.2720804810523 )
set r_array = ( 6.423015933036804e-06 6.341947345733642e-06 3.479620163440704e-06 6.491129665374755e-06 6.382348279953002e-06 4.891113667488098e-06 6.438474040031433e-06 6.476778988838195e-06 6.087356142997741e-06 6.357598357200622e-06 6.471471648216247e-06 6.422974090576171e-06 6.4587695646286e-06 6.392285113334655e-06 6.466951804161071e-06 6.411629204750061e-06 6.332155995368957e-06 6.421174435615539e-06 6.497398738861084e-06 6.355821661949157e-06 6.439329342842102e-06 6.2530793237686154e-06 5.6047267484664915e-06 5.384887318611144e-06 6.219018702507018e-06 5.044087557792663e-06 4.63138828754425e-06 6.407393460273742e-06 6.192056279182434e-06 6.3371187257766715e-06 6.426496796607971e-06 6.433759360313415e-06 2.9710496100783346e-06 2.950907561480999e-06 6.485074310302734e-06 6.422175436019897e-06 6.485891418457031e-06 6.501289873123169e-06 6.398085551261901e-06 6.321738724708557e-06 6.415398888587951e-06 6.2213288354873655e-06 4.173367516994476e-06 6.4666938829421995e-06 6.279665164947509e-06 6.476457123756408e-06 6.082234196662902e-06 6.353796272277831e-06 6.502112989425658e-06 6.425799422264098e-06 6.360887603759765e-06 6.343009285926818e-06 6.4688447999954215e-06 6.401579933166504e-06 6.481253986358642e-06 3.718450384140014e-06 6.463595395088195e-06 6.495115213394164e-06 6.4869986343383785e-06 6.355271487236023e-06 4.005214147567748e-06 6.4875213432312e-06 6.449188284873962e-06 4.235051350593566e-06 6.337000708580017e-06 6.413703517913818e-06 6.4548183488845816e-06 5.913367896080016e-06 6.416766171455383e-06 6.441982798576354e-06 6.454258303642272e-06 6.4522318410873406e-06 6.486112003326415e-06 6.296161823272705e-06 6.428834824562072e-06 6.49179871559143e-06 4.075156288146972e-06 4.881159024238586e-06 6.483330659866332e-06 6.4987355518341056e-06 5.383401160240173e-06 6.481514053344726e-06 6.09196653842926e-06 5.628229551315307e-06 4.603255133628845e-06 6.463379960060119e-06 6.428206114768981e-06 6.445693688392639e-06 6.462061171531677e-06 6.21060986995697e-06 6.429855780601501e-06 6.499264698028564e-06 6.375496201515197e-06 6.492327003479003e-06 6.379758553504944e-06 5.167725806236267e-06 6.315152506828307e-06 6.425584201812744e-06 3.466654794216156e-06 6.296615653038024e-06 6.3972293901443476e-06 6.399844651222229e-06 6.483965806961059e-06 5.807056288719176e-06 6.28536925792694e-06 3.4632085311412807e-06 4.5177445936203e-06 6.375115756988525e-06 6.385789017677306e-06 6.4646116304397574e-06 6.362982945442199e-06 6.487765102386474e-06 6.46619692325592e-06 6.429572968482971e-06 5.995615153312682e-06 3.8614983844757075e-06 6.490722398757934e-06 6.468814330101013e-06 4.504718499183654e-06 6.496407394409179e-06 5.119316010475158e-06 6.142158608436584e-06 3.7509396600723263e-06 6.490871744155883e-06 6.446093230247497e-06 5.914344863891601e-06 6.463043932914733e-06 5.367015008926391e-06 5.5442133235931394e-06 6.402602820396422e-06 5.912128071784973e-06 4.7831378030776975e-06 6.153911833763122e-06 6.4378054189682e-06 6.400798444747925e-06 6.416127591133117e-06 6.445387701988219e-06 6.4286704587936395e-06 6.203239588737487e-06 6.445785098075866e-06 6.491039972305297e-06 6.459144215583801e-06 6.362991528511047e-06 6.167937426567077e-06 5.543018345832824e-06 6.4752829599380485e-06 6.254725556373595e-06 5.6788454103469844e-06 6.502526693344116e-06 6.464838652610778e-06 6.495338802337646e-06 6.455813555717468e-06 6.50426733970642e-06 6.3880053806304925e-06 3.6344209599494932e-06 6.403862600326538e-06 6.488509254455566e-06 6.499523906707763e-06 6.114724974632263e-06 6.444443135261535e-06 6.417575554847717e-06 5.981698780059814e-06 6.355523614883422e-06 6.083556847572326e-06 6.4821140098571775e-06 3.407637773752212e-06 4.107356529235839e-06 6.456332402229309e-06 6.428053336143493e-06 6.485539083480835e-06 6.463917260169982e-06 5.840433912277221e-06 6.467107586860656e-06 6.381521944999694e-06 6.282416467666625e-06 6.08532796382904e-06 6.505260400772094e-06 6.294866423606872e-06 4.950738315582275e-06 6.441039519309997e-06 6.423346381187439e-06 5.366896347999572e-06 6.416907362937927e-06 6.40243309020996e-06 6.393679862022399e-06 6.485153274536132e-06 3.5644424486160275e-06 6.388780646324157e-06 6.3366466569900505e-06 6.353976302146911e-06 6.267149333953857e-06 6.530806617736816e-06 6.36310911655426e-06 4.130251758098602e-06 6.427749495506286e-06 6.491969089508056e-06 6.405242328643798e-06 6.373579602241516e-06 4.521278028488159e-06 6.472708897590636e-06 6.435250239372253e-06 6.458936505317687e-06 6.460889582633972e-06 6.4266111660003656e-06 6.373639469146728e-06 6.2806039381027215e-06 6.533074264526367e-06 3.1646354842185973e-06 6.099820690155029e-06 6.487711887359618e-06 3.047661640048027e-06 6.4187243986129756e-06 6.268201189041137e-06 6.501655082702636e-06 6.486239461898803e-06 6.4505130815505975e-06 6.37490225315094e-06 6.468426804542541e-06 6.507519035339355e-06 6.422935252189636e-06 6.499462966918945e-06 6.4777055311202995e-06 6.464315514564514e-06 6.333387022018432e-06 3.688917117118835e-06 6.406454043388366e-06 6.392768340110778e-06 6.46157365322113e-06 6.405357985496521e-06 6.426993970870971e-06 6.2632524061203e-06 6.467739729881286e-06 6.4859583663940425e-06 5.165695481300353e-06 6.370117192268371e-06 6.400974612236022e-06 6.471364359855651e-06 4.960399632453918e-06 6.420863299369812e-06 6.487635498046874e-06 6.463518576622009e-06 6.50298502922058e-06 6.425991039276123e-06 6.08376284122467e-06 6.47907968044281e-06 6.399899153709411e-06 6.2686127471923825e-06 6.186042122840881e-06 6.370448927879333e-06 3.920812110900879e-06 5.910810570716858e-06 6.419711880683898e-06 6.445261960029601e-06 5.240600352287292e-06 6.345034461021423e-06 6.28018937587738e-06 6.2595539617538444e-06 6.472157435417175e-06 6.236697678565978e-06 6.379352788925171e-06 6.322188477516174e-06 6.295488696098327e-06 6.267157273292541e-06 6.10842264175415e-06 5.5400280046463e-06 6.17053852558136e-06 6.467527728080749e-06 6.301217465400695e-06 6.459258370399475e-06 6.495099334716796e-06 6.257942490577697e-06 6.448155312538146e-06 6.49358184814453e-06 6.385534958839416e-06 6.387230973243713e-06 6.245825557708739e-06 6.468098931312561e-06 6.491338233947753e-06 6.444746975898742e-06 6.483037118911743e-06 5.954339818954467e-06 6.020644454956054e-06 2.8938456601649522e-06 6.479249196052551e-06 5.614762072563171e-06 6.437771086692809e-06 6.430948405265807e-06 6.428706936836242e-06 6.520366601943969e-06 6.428645567893981e-06 6.435188012123108e-06 4.795256023406982e-06 6.434591488838195e-06 6.379078774452209e-06 6.099167304039001e-06 6.490209560394286e-06 5.32651665687561e-06 6.502360610961913e-06 6.4262011098861685e-06 6.280328421592712e-06 4.463946239948272e-06 5.810791640281677e-06 5.046333746910095e-06 6.282258753776549e-06 6.496235733032226e-06 6.442290930747985e-06 5.209118728637695e-06 5.279086833000183e-06 6.481149272918701e-06 6.456802325248717e-06 6.373100666999816e-06 6.265974311828613e-06 6.267183022499084e-06 6.408973174095153e-06 6.27783911705017e-06 3.961546711921692e-06 6.4160898256301875e-06 6.472999863624572e-06 )
set i = 318
let index = 1
repeat $i
    let r_test = $r_array[$&index]
    alter @mn0[w] = $w_array[$&index]
    alter R0 = r_test
    op
    let gm = @mn0[gm]
    let ro = 1/@mn0[gds]
    let a0 = gm*r_test
    let id = @mn0[id]
    let pw = id*1.2
    let cgd = @mn0[cgd]
    let cdb = abs(@mn0[cdb])
    let cp = (1+a0)*cgd+cdb
    let bw = 1/(2*pi*r_test*cp)
    wrdata ../out/r-test.csv $r_array[$&index]
    wrdata ../out/w-test.csv $w_array[$&index]
    wrdata ../out/bw-test.csv bw
    wrdata ../out/pw-test.csv pw
    wrdata ../out/a0-test.csv a0
    set appendwrite
    let index = index + 1
end

.endc

.end

