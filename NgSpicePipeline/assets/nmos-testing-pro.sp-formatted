nmos: cs amp

.include ../assets/45nm_CS.pm

.option TEMP=27C

V6 net2 0 dc 822.6m ac 1
Vdd net1 0 dc 1.2
R0 net1 out 500
mn0 out net2 0 0 NMOS W=5u L=45n

.control
set w_array = ( 1417.2353234887123 1150.5699601769447 1427.368378341198 874.2961038649082 1431.775828897953 1306.82049959898 1071.8624231219292 1152.0935621857643 913.4633314609528 1423.8416311144829 1426.516195833683 679.4153888523579 784.8919429630041 999.191342741251 1427.8126147389412 1287.070223391056 1352.4755504727364 1427.4559077620506 1430.2084621787071 1074.7254711389542 959.6928556263447 1345.8692428469658 838.9639680087566 1427.9259112477303 732.4939303845167 894.3487991392612 712.5622396171093 1002.1180708706379 1422.164115011692 1097.616135776043 659.2871963791549 1371.1500015854836 1218.896163702011 1423.0441299080849 1090.0877204537392 1011.3272477686405 769.206031486392 717.699835523963 944.1730533540249 1427.1502432227135 854.2755436897278 1423.15732806921 1314.8177382349968 1324.8142865300179 959.9965532124043 971.4548920094967 723.8553174585104 1422.8574660420418 798.1930219382048 1205.4809030890465 1425.9870854020119 816.080544218421 1059.7578909993172 813.7803890556097 1425.471546947956 1409.4086197018623 750.4038021713495 1113.5017421841621 1104.6915125846863 1433.4723260998726 862.5498031079769 1346.8137246370316 927.1916081011295 809.415867254138 1009.5399264991283 1309.933793246746 1111.0654246807098 1420.8687779307365 1421.1486753821373 1107.2051313519478 1423.7252858281136 722.1304469555616 755.522035881877 1285.807095170021 1129.5228716731071 1423.411753475666 1038.09072047472 1417.4481478333473 1061.932062804699 659.7733903490007 1424.692830145359 1357.5329807400703 828.9667066931725 889.6186944842339 )
set r_array = ( 5.775832210779189e-06 6.613358681201935e-06 3.99394040286541e-06 6.480002825260162e-06 2.806180327311158e-06 6.6010761755704876e-06 6.621717338562011e-06 6.6174812364578246e-06 6.48813170671463e-06 3.312905741035938e-06 6.455630038976669e-06 6.642553632259368e-06 6.035983686447143e-06 6.612371181249618e-06 6.059344609379768e-06 6.611676042079925e-06 6.618937452435493e-06 3.6608852568268772e-06 6.146661688685416e-06 6.621393685340881e-06 6.575873245596885e-06 6.609167729616165e-06 6.3960036385059354e-06 3.809416716098785e-06 6.576756809949874e-06 6.486917560100555e-06 6.630308454036712e-06 6.615968694090843e-06 5.334507797956466e-06 6.621844967007637e-06 6.646910433769225e-06 6.62174952507019e-06 6.597166632413864e-06 5.767209355831146e-06 6.627104555368423e-06 6.61644009232521e-06 6.1410395550727844e-06 6.588461970090866e-06 6.556259815692902e-06 6.15911227941513e-06 6.312217463850975e-06 3.243725200295448e-06 6.603165392875671e-06 6.606516813039779e-06 6.597368245124817e-06 6.605481256842613e-06 6.6583080339431755e-06 4.763614361286163e-06 6.057410066127776e-06 6.6210382926464075e-06 4.22393323212862e-06 6.290841822624206e-06 6.621866201162338e-06 6.049574439525604e-06 4.307305340766907e-06 6.618363236188888e-06 6.4951993274688716e-06 6.623051066994667e-06 6.624654357433319e-06 6.273934294581413e-06 6.453230355978012e-06 6.6136313724517815e-06 6.520165776014328e-06 6.032423053979874e-06 6.6141090291738505e-06 6.607213516831398e-06 6.626242225170135e-06 5.2879433083534234e-06 6.32458557665348e-06 6.619529997110366e-06 4.9417385208606715e-06 6.48289067029953e-06 5.916514520645141e-06 6.606667463779449e-06 6.617664073705673e-06 6.008057196736335e-06 6.621441965103149e-06 5.397386823892593e-06 6.62224305152893e-06 6.647981529235839e-06 5.8054813492298125e-06 6.616059218645095e-06 6.303916697502136e-06 6.493492548465729e-06 )
set i = 84
let index = 1
repeat $i
    let r_test = $r_array[$&index]
    alter @mn0[w] = $w_array[$&index]
    alter R0 = r_test
    op
    let gm = @mn0[gm]
    let ro = 1/@mn0[gds]
    let a0 = gm*r_test
    let id = @mn0[id]
    let pw = id*1.2
    let cgd = @mn0[cgd]
    let cdb = abs(@mn0[cdb])
    let cp = (1+a0)*cgd+cdb
    let bw = 1/(2*pi*r_test*cp)
    wrdata ../out/r-test.csv $r_array[$&index]
    wrdata ../out/w-test.csv $w_array[$&index]
    wrdata ../out/bw-test.csv bw
    wrdata ../out/pw-test.csv pw
    wrdata ../out/a0-test.csv a0
    set appendwrite
    let index = index + 1
end

.endc

.end

